[
  structure_item (src/AutomatonGraph.ml[14,1004+0]..[14,1004+11])
    Pstr_open Fresh
    module_expr (src/AutomatonGraph.ml[14,1004+5]..[14,1004+11])
      Pmod_ident "Printf" (src/AutomatonGraph.ml[14,1004+5]..[14,1004+11])
  structure_item (src/AutomatonGraph.ml[15,1016+0]..[15,1016+12])
    Pstr_open Fresh
    module_expr (src/AutomatonGraph.ml[15,1016+5]..[15,1016+12])
      Pmod_ident "Grammar" (src/AutomatonGraph.ml[15,1016+5]..[15,1016+12])
  structure_item (src/AutomatonGraph.ml[17,1030+0]..[36,1555+4])
    Pstr_module
    "P" (src/AutomatonGraph.ml[17,1030+7]..[17,1030+8])
      module_expr (src/AutomatonGraph.ml[17,1030+11]..[36,1555+4])
        Pmod_apply
        module_expr (src/AutomatonGraph.ml[17,1030+11]..[17,1030+20])
          Pmod_ident "Dot.Print" (src/AutomatonGraph.ml[17,1030+11]..[17,1030+20])
        module_expr (src/AutomatonGraph.ml[17,1030+22]..[36,1555+3])
          Pmod_structure
          [
            structure_item (src/AutomatonGraph.ml[19,1060+2]..[19,1060+24])
              Pstr_type Rec
              [
                type_declaration "vertex" (src/AutomatonGraph.ml[19,1060+7]..[19,1060+13]) (src/AutomatonGraph.ml[19,1060+2]..[19,1060+24])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (src/AutomatonGraph.ml[19,1060+16]..[19,1060+24])
                        Ptyp_constr "Lr1.node" (src/AutomatonGraph.ml[19,1060+16]..[19,1060+24])
                        []
              ]
            structure_item (src/AutomatonGraph.ml[21,1086+2]..[22,1104+35])
              Pstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[21,1086+6]..[21,1086+10])
                    Ppat_var "name" (src/AutomatonGraph.ml[21,1086+6]..[21,1086+10])
                  expression (src/AutomatonGraph.ml[21,1086+11]..[22,1104+35]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (src/AutomatonGraph.ml[21,1086+11]..[21,1086+15])
                      Ppat_var "node" (src/AutomatonGraph.ml[21,1086+11]..[21,1086+15])
                    expression (src/AutomatonGraph.ml[22,1104+4]..[22,1104+35])
                      Pexp_apply
                      expression (src/AutomatonGraph.ml[22,1104+4]..[22,1104+11])
                        Pexp_ident "sprintf" (src/AutomatonGraph.ml[22,1104+4]..[22,1104+11])
                      [
                        <arg>
                        Nolabel
                          expression (src/AutomatonGraph.ml[22,1104+12]..[22,1104+17])
                            Pexp_constant PConst_string("s%d",(src/AutomatonGraph.ml[22,1104+13]..[22,1104+16]),None)
                        <arg>
                        Nolabel
                          expression (src/AutomatonGraph.ml[22,1104+18]..[22,1104+35])
                            Pexp_apply
                            expression (src/AutomatonGraph.ml[22,1104+19]..[22,1104+29])
                              Pexp_ident "Lr1.number" (src/AutomatonGraph.ml[22,1104+19]..[22,1104+29])
                            [
                              <arg>
                              Nolabel
                                expression (src/AutomatonGraph.ml[22,1104+30]..[22,1104+34])
                                  Pexp_ident "node" (src/AutomatonGraph.ml[22,1104+30]..[22,1104+34])
                            ]
                      ]
              ]
            structure_item (src/AutomatonGraph.ml[24,1141+2]..[28,1328+30])
              Pstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[24,1141+6]..[24,1141+16])
                    Ppat_var "successors" (src/AutomatonGraph.ml[24,1141+6]..[24,1141+16])
                  expression (src/AutomatonGraph.ml[24,1141+17]..[28,1328+30]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (src/AutomatonGraph.ml[24,1141+17]..[24,1141+73])
                      Ppat_constraint
                      pattern (src/AutomatonGraph.ml[24,1141+18]..[24,1141+19])
                        Ppat_var "f" (src/AutomatonGraph.ml[24,1141+18]..[24,1141+19])
                      core_type (src/AutomatonGraph.ml[24,1141+22]..[24,1141+72])
                        Ptyp_arrow
                        Optional "style"
                        core_type (src/AutomatonGraph.ml[24,1141+29]..[24,1141+38])
                          Ptyp_constr "Dot.style" (src/AutomatonGraph.ml[24,1141+29]..[24,1141+38])
                          []
                        core_type (src/AutomatonGraph.ml[24,1141+42]..[24,1141+72])
                          Ptyp_arrow
                          Labelled "label"
                          core_type (src/AutomatonGraph.ml[24,1141+48]..[24,1141+54])
                            Ptyp_constr "string" (src/AutomatonGraph.ml[24,1141+48]..[24,1141+54])
                            []
                          core_type (src/AutomatonGraph.ml[24,1141+58]..[24,1141+72])
                            Ptyp_arrow
                            Nolabel
                            core_type (src/AutomatonGraph.ml[24,1141+58]..[24,1141+64])
                              Ptyp_constr "vertex" (src/AutomatonGraph.ml[24,1141+58]..[24,1141+64])
                              []
                            core_type (src/AutomatonGraph.ml[24,1141+68]..[24,1141+72])
                              Ptyp_constr "unit" (src/AutomatonGraph.ml[24,1141+68]..[24,1141+72])
                              []
                    expression (src/AutomatonGraph.ml[24,1141+74]..[28,1328+30]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (src/AutomatonGraph.ml[24,1141+74]..[24,1141+80])
                        Ppat_var "source" (src/AutomatonGraph.ml[24,1141+74]..[24,1141+80])
                      expression (src/AutomatonGraph.ml[25,1224+4]..[28,1328+30])
                        Pexp_apply
                        expression (src/AutomatonGraph.ml[25,1224+4]..[25,1224+18])
                          Pexp_ident "SymbolMap.iter" (src/AutomatonGraph.ml[25,1224+4]..[25,1224+18])
                        [
                          <arg>
                          Nolabel
                            expression (src/AutomatonGraph.ml[25,1224+19]..[28,1328+5])
                              Pexp_fun
                              Nolabel
                              None
                              pattern (src/AutomatonGraph.ml[25,1224+24]..[25,1224+30])
                                Ppat_var "symbol" (src/AutomatonGraph.ml[25,1224+24]..[25,1224+30])
                              expression (src/AutomatonGraph.ml[25,1224+31]..[27,1306+21]) ghost
                                Pexp_fun
                                Nolabel
                                None
                                pattern (src/AutomatonGraph.ml[25,1224+31]..[25,1224+37])
                                  Ppat_var "target" (src/AutomatonGraph.ml[25,1224+31]..[25,1224+37])
                                expression (src/AutomatonGraph.ml[26,1265+6]..[27,1306+21])
                                  Pexp_let Nonrec
                                  [
                                    <def>
                                      pattern (src/AutomatonGraph.ml[26,1265+10]..[26,1265+15])
                                        Ppat_var "label" (src/AutomatonGraph.ml[26,1265+10]..[26,1265+15])
                                      expression (src/AutomatonGraph.ml[26,1265+18]..[26,1265+37])
                                        Pexp_apply
                                        expression (src/AutomatonGraph.ml[26,1265+18]..[26,1265+30])
                                          Pexp_ident "Symbol.print" (src/AutomatonGraph.ml[26,1265+18]..[26,1265+30])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (src/AutomatonGraph.ml[26,1265+31]..[26,1265+37])
                                              Pexp_ident "symbol" (src/AutomatonGraph.ml[26,1265+31]..[26,1265+37])
                                        ]
                                  ]
                                  expression (src/AutomatonGraph.ml[27,1306+6]..[27,1306+21])
                                    Pexp_apply
                                    expression (src/AutomatonGraph.ml[27,1306+6]..[27,1306+7])
                                      Pexp_ident "f" (src/AutomatonGraph.ml[27,1306+6]..[27,1306+7])
                                    [
                                      <arg>
                                      Labelled "label"
                                        expression (src/AutomatonGraph.ml[27,1306+9]..[27,1306+14])
                                          Pexp_ident "label" (src/AutomatonGraph.ml[27,1306+9]..[27,1306+14])
                                      <arg>
                                      Nolabel
                                        expression (src/AutomatonGraph.ml[27,1306+15]..[27,1306+21])
                                          Pexp_ident "target" (src/AutomatonGraph.ml[27,1306+15]..[27,1306+21])
                                    ]
                          <arg>
                          Nolabel
                            expression (src/AutomatonGraph.ml[28,1328+6]..[28,1328+30])
                              Pexp_apply
                              expression (src/AutomatonGraph.ml[28,1328+7]..[28,1328+22])
                                Pexp_ident "Lr1.transitions" (src/AutomatonGraph.ml[28,1328+7]..[28,1328+22])
                              [
                                <arg>
                                Nolabel
                                  expression (src/AutomatonGraph.ml[28,1328+23]..[28,1328+29])
                                    Pexp_ident "source" (src/AutomatonGraph.ml[28,1328+23]..[28,1328+29])
                              ]
                        ]
              ]
            structure_item (src/AutomatonGraph.ml[30,1360+2]..[34,1548+5])
              Pstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[30,1360+6]..[30,1360+10])
                    Ppat_var "iter" (src/AutomatonGraph.ml[30,1360+6]..[30,1360+10])
                  expression (src/AutomatonGraph.ml[30,1360+11]..[34,1548+5]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (src/AutomatonGraph.ml[30,1360+11]..[30,1360+87])
                      Ppat_constraint
                      pattern (src/AutomatonGraph.ml[30,1360+12]..[30,1360+13])
                        Ppat_var "f" (src/AutomatonGraph.ml[30,1360+12]..[30,1360+13])
                      core_type (src/AutomatonGraph.ml[30,1360+16]..[30,1360+86])
                        Ptyp_arrow
                        Optional "shape"
                        core_type (src/AutomatonGraph.ml[30,1360+23]..[30,1360+32])
                          Ptyp_constr "Dot.shape" (src/AutomatonGraph.ml[30,1360+23]..[30,1360+32])
                          []
                        core_type (src/AutomatonGraph.ml[30,1360+36]..[30,1360+86])
                          Ptyp_arrow
                          Optional "style"
                          core_type (src/AutomatonGraph.ml[30,1360+43]..[30,1360+52])
                            Ptyp_constr "Dot.style" (src/AutomatonGraph.ml[30,1360+43]..[30,1360+52])
                            []
                          core_type (src/AutomatonGraph.ml[30,1360+56]..[30,1360+86])
                            Ptyp_arrow
                            Labelled "label"
                            core_type (src/AutomatonGraph.ml[30,1360+62]..[30,1360+68])
                              Ptyp_constr "string" (src/AutomatonGraph.ml[30,1360+62]..[30,1360+68])
                              []
                            core_type (src/AutomatonGraph.ml[30,1360+72]..[30,1360+86])
                              Ptyp_arrow
                              Nolabel
                              core_type (src/AutomatonGraph.ml[30,1360+72]..[30,1360+78])
                                Ptyp_constr "vertex" (src/AutomatonGraph.ml[30,1360+72]..[30,1360+78])
                                []
                              core_type (src/AutomatonGraph.ml[30,1360+82]..[30,1360+86])
                                Ptyp_constr "unit" (src/AutomatonGraph.ml[30,1360+82]..[30,1360+86])
                                []
                    expression (src/AutomatonGraph.ml[31,1450+4]..[34,1548+5])
                      Pexp_apply
                      expression (src/AutomatonGraph.ml[31,1450+4]..[31,1450+12])
                        Pexp_ident "Lr1.iter" (src/AutomatonGraph.ml[31,1450+4]..[31,1450+12])
                      [
                        <arg>
                        Nolabel
                          expression (src/AutomatonGraph.ml[31,1450+13]..[34,1548+5])
                            Pexp_fun
                            Nolabel
                            None
                            pattern (src/AutomatonGraph.ml[31,1450+18]..[31,1450+22])
                              Ppat_var "node" (src/AutomatonGraph.ml[31,1450+18]..[31,1450+22])
                            expression (src/AutomatonGraph.ml[32,1476+6]..[33,1528+19])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (src/AutomatonGraph.ml[32,1476+10]..[32,1476+15])
                                    Ppat_var "label" (src/AutomatonGraph.ml[32,1476+10]..[32,1476+15])
                                  expression (src/AutomatonGraph.ml[32,1476+18]..[32,1476+48])
                                    Pexp_apply
                                    expression (src/AutomatonGraph.ml[32,1476+18]..[32,1476+25])
                                      Pexp_ident "sprintf" (src/AutomatonGraph.ml[32,1476+18]..[32,1476+25])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (src/AutomatonGraph.ml[32,1476+26]..[32,1476+30])
                                          Pexp_constant PConst_string("%d",(src/AutomatonGraph.ml[32,1476+27]..[32,1476+29]),None)
                                      <arg>
                                      Nolabel
                                        expression (src/AutomatonGraph.ml[32,1476+31]..[32,1476+48])
                                          Pexp_apply
                                          expression (src/AutomatonGraph.ml[32,1476+32]..[32,1476+42])
                                            Pexp_ident "Lr1.number" (src/AutomatonGraph.ml[32,1476+32]..[32,1476+42])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (src/AutomatonGraph.ml[32,1476+43]..[32,1476+47])
                                                Pexp_ident "node" (src/AutomatonGraph.ml[32,1476+43]..[32,1476+47])
                                          ]
                                    ]
                              ]
                              expression (src/AutomatonGraph.ml[33,1528+6]..[33,1528+19])
                                Pexp_apply
                                expression (src/AutomatonGraph.ml[33,1528+6]..[33,1528+7])
                                  Pexp_ident "f" (src/AutomatonGraph.ml[33,1528+6]..[33,1528+7])
                                [
                                  <arg>
                                  Labelled "label"
                                    expression (src/AutomatonGraph.ml[33,1528+9]..[33,1528+14])
                                      Pexp_ident "label" (src/AutomatonGraph.ml[33,1528+9]..[33,1528+14])
                                  <arg>
                                  Nolabel
                                    expression (src/AutomatonGraph.ml[33,1528+15]..[33,1528+19])
                                      Pexp_ident "node" (src/AutomatonGraph.ml[33,1528+15]..[33,1528+19])
                                ]
                      ]
              ]
          ]
  structure_item (src/AutomatonGraph.ml[38,1561+0]..[41,1651+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/AutomatonGraph.ml[38,1561+4]..[38,1561+25])
          Ppat_var "print_automaton_graph" (src/AutomatonGraph.ml[38,1561+4]..[38,1561+25])
        expression (src/AutomatonGraph.ml[38,1561+25]..[41,1651+13]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/AutomatonGraph.ml[38,1561+25]..[38,1561+27])
            Ppat_construct "()" (src/AutomatonGraph.ml[38,1561+25]..[38,1561+27])
            None
          expression (src/AutomatonGraph.ml[39,1591+2]..[41,1651+13])
            Pexp_let Nonrec
            [
              <def>
                pattern (src/AutomatonGraph.ml[39,1591+6]..[39,1591+7])
                  Ppat_var "f" (src/AutomatonGraph.ml[39,1591+6]..[39,1591+7])
                expression (src/AutomatonGraph.ml[39,1591+10]..[39,1591+43])
                  Pexp_apply
                  expression (src/AutomatonGraph.ml[39,1591+10]..[39,1591+18])
                    Pexp_ident "open_out" (src/AutomatonGraph.ml[39,1591+10]..[39,1591+18])
                  [
                    <arg>
                    Nolabel
                      expression (src/AutomatonGraph.ml[39,1591+19]..[39,1591+43])
                        Pexp_apply
                        expression (src/AutomatonGraph.ml[39,1591+34]..[39,1591+35])
                          Pexp_ident "^" (src/AutomatonGraph.ml[39,1591+34]..[39,1591+35])
                        [
                          <arg>
                          Nolabel
                            expression (src/AutomatonGraph.ml[39,1591+20]..[39,1591+33])
                              Pexp_ident "Settings.base" (src/AutomatonGraph.ml[39,1591+20]..[39,1591+33])
                          <arg>
                          Nolabel
                            expression (src/AutomatonGraph.ml[39,1591+36]..[39,1591+42])
                              Pexp_constant PConst_string(".dot",(src/AutomatonGraph.ml[39,1591+37]..[39,1591+41]),None)
                        ]
                  ]
            ]
            expression (src/AutomatonGraph.ml[40,1638+2]..[41,1651+13])
              Pexp_sequence
              expression (src/AutomatonGraph.ml[40,1638+2]..[40,1638+11])
                Pexp_apply
                expression (src/AutomatonGraph.ml[40,1638+2]..[40,1638+9])
                  Pexp_ident "P.print" (src/AutomatonGraph.ml[40,1638+2]..[40,1638+9])
                [
                  <arg>
                  Nolabel
                    expression (src/AutomatonGraph.ml[40,1638+10]..[40,1638+11])
                      Pexp_ident "f" (src/AutomatonGraph.ml[40,1638+10]..[40,1638+11])
                ]
              expression (src/AutomatonGraph.ml[41,1651+2]..[41,1651+13])
                Pexp_apply
                expression (src/AutomatonGraph.ml[41,1651+2]..[41,1651+11])
                  Pexp_ident "close_out" (src/AutomatonGraph.ml[41,1651+2]..[41,1651+11])
                [
                  <arg>
                  Nolabel
                    expression (src/AutomatonGraph.ml[41,1651+12]..[41,1651+13])
                      Pexp_ident "f" (src/AutomatonGraph.ml[41,1651+12]..[41,1651+13])
                ]
    ]
]

open Printf
open Grammar
module P =
  (Dot.Print)(struct
                type vertex = Lr1.node
                let name node = sprintf "s%d" (Lr1.number node)
                let successors
                  (f : ?style:Dot.style -> label:string -> vertex -> unit)
                  source =
                  SymbolMap.iter
                    (fun symbol ->
                       fun target ->
                         let label = Symbol.print symbol in f ~label target)
                    (Lr1.transitions source)
                let iter
                  (f :
                    ?shape:Dot.shape ->
                      ?style:Dot.style -> label:string -> vertex -> unit)
                  =
                  Lr1.iter
                    (fun node ->
                       let label = sprintf "%d" (Lr1.number node) in
                       f ~label node)
              end)
let print_automaton_graph () =
  let f = open_out (Settings.base ^ ".dot") in P.print f; close_out f
[
  structure_item (src/AutomatonGraph.ml[14,1004+0]..src/AutomatonGraph.ml[14,1004+11])
    Tstr_open Fresh
    module_expr (src/AutomatonGraph.ml[14,1004+5]..src/AutomatonGraph.ml[14,1004+11])
      Tmod_ident "Stdlib!.Printf"
  structure_item (src/AutomatonGraph.ml[15,1016+0]..src/AutomatonGraph.ml[15,1016+12])
    Tstr_open Fresh
    module_expr (src/AutomatonGraph.ml[15,1016+5]..src/AutomatonGraph.ml[15,1016+12])
      Tmod_ident "Dune__exe!.Grammar"
  structure_item (src/AutomatonGraph.ml[17,1030+0]..src/AutomatonGraph.ml[36,1555+4])
    Tstr_module
    P/705
      module_expr (src/AutomatonGraph.ml[17,1030+11]..src/AutomatonGraph.ml[36,1555+4])
        Tmod_apply
        module_expr (src/AutomatonGraph.ml[17,1030+11]..src/AutomatonGraph.ml[17,1030+20])
          module_expr (src/AutomatonGraph.ml[17,1030+11]..src/AutomatonGraph.ml[17,1030+20])
            Tmod_ident "Dune__exe!.Dot.Print"
        module_expr (src/AutomatonGraph.ml[17,1030+22]..src/AutomatonGraph.ml[36,1555+3])
          Tmod_structure
          [
            structure_item (src/AutomatonGraph.ml[19,1060+2]..src/AutomatonGraph.ml[19,1060+24])
              Tstr_type Rec
              [
                type_declaration vertex/426 (src/AutomatonGraph.ml[19,1060+2]..src/AutomatonGraph.ml[19,1060+24])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ttype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (src/AutomatonGraph.ml[19,1060+16]..src/AutomatonGraph.ml[19,1060+24])
                        Ttyp_constr "Dune__exe!.Lr1.node"
                        []
              ]
            structure_item (src/AutomatonGraph.ml[21,1086+2]..src/AutomatonGraph.ml[22,1104+35])
              Tstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[21,1086+6]..src/AutomatonGraph.ml[21,1086+10])
                    Tpat_var "name/509"
                  expression (src/AutomatonGraph.ml[21,1086+11]..src/AutomatonGraph.ml[22,1104+35]) ghost
                    Texp_function
                    Nolabel
                    [
                      <case>
                        pattern (src/AutomatonGraph.ml[21,1086+11]..src/AutomatonGraph.ml[21,1086+15])
                          Tpat_var "node/511"
                        expression (src/AutomatonGraph.ml[22,1104+4]..src/AutomatonGraph.ml[22,1104+35])
                          Texp_apply
                          expression (src/AutomatonGraph.ml[22,1104+4]..src/AutomatonGraph.ml[22,1104+11])
                            Texp_ident "Stdlib!.Printf.sprintf"
                          [
                            <arg>
                              Nolabel
                              expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17])
                                Texp_construct "CamlinternalFormatBasics.Format"
                                [
                                  expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                    Texp_construct "CamlinternalFormatBasics.Char_literal"
                                    [
                                      expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                        Texp_constant Const_char 73
                                      expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                        Texp_construct "CamlinternalFormatBasics.Int"
                                        [
                                          expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                            Texp_construct "CamlinternalFormatBasics.Int_d"
                                            []
                                          expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                            Texp_construct "CamlinternalFormatBasics.No_padding"
                                            []
                                          expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                            Texp_construct "CamlinternalFormatBasics.No_precision"
                                            []
                                          expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                            Texp_construct "CamlinternalFormatBasics.End_of_format"
                                            []
                                        ]
                                    ]
                                  expression (src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost
                                    Texp_constant Const_string("s%d",(src/AutomatonGraph.ml[22,1104+12]..src/AutomatonGraph.ml[22,1104+17]) ghost,None)
                                ]
                            <arg>
                              Nolabel
                              expression (src/AutomatonGraph.ml[22,1104+18]..src/AutomatonGraph.ml[22,1104+35])
                                Texp_apply
                                expression (src/AutomatonGraph.ml[22,1104+19]..src/AutomatonGraph.ml[22,1104+29])
                                  Texp_ident "Dune__exe!.Lr1.number"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/AutomatonGraph.ml[22,1104+30]..src/AutomatonGraph.ml[22,1104+34])
                                      Texp_ident "node/511"
                                ]
                          ]
                    ]
              ]
            structure_item (src/AutomatonGraph.ml[24,1141+2]..src/AutomatonGraph.ml[28,1328+30])
              Tstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[24,1141+6]..src/AutomatonGraph.ml[24,1141+16])
                    Tpat_var "successors/535"
                  expression (src/AutomatonGraph.ml[24,1141+17]..src/AutomatonGraph.ml[28,1328+30]) ghost
                    Texp_function
                    Nolabel
                    [
                      <case>
                        pattern (src/AutomatonGraph.ml[24,1141+18]..src/AutomatonGraph.ml[24,1141+19])
                          extra
                            Tpat_extra_constraint
                            core_type (src/AutomatonGraph.ml[24,1141+22]..src/AutomatonGraph.ml[24,1141+72])
                              Ttyp_arrow
                              Optional "style"
                              core_type (src/AutomatonGraph.ml[24,1141+29]..src/AutomatonGraph.ml[24,1141+38])
                                Ttyp_constr "Dune__exe!.Dot.style"
                                []
                              core_type (src/AutomatonGraph.ml[24,1141+42]..src/AutomatonGraph.ml[24,1141+72])
                                Ttyp_arrow
                                Labelled "label"
                                core_type (src/AutomatonGraph.ml[24,1141+48]..src/AutomatonGraph.ml[24,1141+54])
                                  Ttyp_constr "string/15!"
                                  []
                                core_type (src/AutomatonGraph.ml[24,1141+58]..src/AutomatonGraph.ml[24,1141+72])
                                  Ttyp_arrow
                                  Nolabel
                                  core_type (src/AutomatonGraph.ml[24,1141+58]..src/AutomatonGraph.ml[24,1141+64])
                                    Ttyp_constr "vertex/426"
                                    []
                                  core_type (src/AutomatonGraph.ml[24,1141+68]..src/AutomatonGraph.ml[24,1141+72])
                                    Ttyp_constr "unit/6!"
                                    []
                          Tpat_alias "f/545"
                          pattern (src/AutomatonGraph.ml[24,1141+18]..src/AutomatonGraph.ml[24,1141+19])
                            Tpat_any
                        expression (src/AutomatonGraph.ml[24,1141+74]..src/AutomatonGraph.ml[28,1328+30]) ghost
                          Texp_function
                          Nolabel
                          [
                            <case>
                              pattern (src/AutomatonGraph.ml[24,1141+74]..src/AutomatonGraph.ml[24,1141+80])
                                Tpat_var "source/546"
                              expression (src/AutomatonGraph.ml[25,1224+4]..src/AutomatonGraph.ml[28,1328+30])
                                Texp_apply
                                expression (src/AutomatonGraph.ml[25,1224+4]..src/AutomatonGraph.ml[25,1224+18])
                                  Texp_ident "Dune__exe!.Grammar.SymbolMap.iter"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/AutomatonGraph.ml[25,1224+19]..src/AutomatonGraph.ml[28,1328+5])
                                      Texp_function
                                      Nolabel
                                      [
                                        <case>
                                          pattern (src/AutomatonGraph.ml[25,1224+24]..src/AutomatonGraph.ml[25,1224+30])
                                            Tpat_var "symbol/612"
                                          expression (src/AutomatonGraph.ml[25,1224+31]..src/AutomatonGraph.ml[27,1306+21]) ghost
                                            Texp_function
                                            Nolabel
                                            [
                                              <case>
                                                pattern (src/AutomatonGraph.ml[25,1224+31]..src/AutomatonGraph.ml[25,1224+37])
                                                  Tpat_var "target/613"
                                                expression (src/AutomatonGraph.ml[26,1265+6]..src/AutomatonGraph.ml[27,1306+21])
                                                  Texp_let Nonrec
                                                  [
                                                    <def>
                                                      pattern (src/AutomatonGraph.ml[26,1265+10]..src/AutomatonGraph.ml[26,1265+15])
                                                        Tpat_var "label/614"
                                                      expression (src/AutomatonGraph.ml[26,1265+18]..src/AutomatonGraph.ml[26,1265+37])
                                                        Texp_apply
                                                        expression (src/AutomatonGraph.ml[26,1265+18]..src/AutomatonGraph.ml[26,1265+30])
                                                          Texp_ident "Dune__exe!.Grammar.Symbol.print"
                                                        [
                                                          <arg>
                                                            Nolabel
                                                            expression (src/AutomatonGraph.ml[26,1265+31]..src/AutomatonGraph.ml[26,1265+37])
                                                              Texp_ident "symbol/612"
                                                        ]
                                                  ]
                                                  expression (src/AutomatonGraph.ml[27,1306+6]..src/AutomatonGraph.ml[27,1306+21])
                                                    Texp_apply
                                                    expression (src/AutomatonGraph.ml[27,1306+6]..src/AutomatonGraph.ml[27,1306+7])
                                                      Texp_ident "f/545"
                                                    [
                                                      <arg>
                                                        Optional "style"
                                                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                                                          Texp_construct "None"
                                                          []
                                                      <arg>
                                                        Labelled "label"
                                                        expression (src/AutomatonGraph.ml[27,1306+9]..src/AutomatonGraph.ml[27,1306+14])
                                                          Texp_ident "label/614"
                                                      <arg>
                                                        Nolabel
                                                        expression (src/AutomatonGraph.ml[27,1306+15]..src/AutomatonGraph.ml[27,1306+21])
                                                          Texp_ident "target/613"
                                                    ]
                                            ]
                                      ]
                                  <arg>
                                    Nolabel
                                    expression (src/AutomatonGraph.ml[28,1328+6]..src/AutomatonGraph.ml[28,1328+30])
                                      Texp_apply
                                      expression (src/AutomatonGraph.ml[28,1328+7]..src/AutomatonGraph.ml[28,1328+22])
                                        Texp_ident "Dune__exe!.Lr1.transitions"
                                      [
                                        <arg>
                                          Nolabel
                                          expression (src/AutomatonGraph.ml[28,1328+23]..src/AutomatonGraph.ml[28,1328+29])
                                            Texp_ident "source/546"
                                      ]
                                ]
                          ]
                    ]
              ]
            structure_item (src/AutomatonGraph.ml[30,1360+2]..src/AutomatonGraph.ml[34,1548+5])
              Tstr_value Nonrec
              [
                <def>
                  pattern (src/AutomatonGraph.ml[30,1360+6]..src/AutomatonGraph.ml[30,1360+10])
                    Tpat_var "iter/685"
                  expression (src/AutomatonGraph.ml[30,1360+11]..src/AutomatonGraph.ml[34,1548+5]) ghost
                    Texp_function
                    Nolabel
                    [
                      <case>
                        pattern (src/AutomatonGraph.ml[30,1360+12]..src/AutomatonGraph.ml[30,1360+13])
                          extra
                            Tpat_extra_constraint
                            core_type (src/AutomatonGraph.ml[30,1360+16]..src/AutomatonGraph.ml[30,1360+86])
                              Ttyp_arrow
                              Optional "shape"
                              core_type (src/AutomatonGraph.ml[30,1360+23]..src/AutomatonGraph.ml[30,1360+32])
                                Ttyp_constr "Dune__exe!.Dot.shape"
                                []
                              core_type (src/AutomatonGraph.ml[30,1360+36]..src/AutomatonGraph.ml[30,1360+86])
                                Ttyp_arrow
                                Optional "style"
                                core_type (src/AutomatonGraph.ml[30,1360+43]..src/AutomatonGraph.ml[30,1360+52])
                                  Ttyp_constr "Dune__exe!.Dot.style"
                                  []
                                core_type (src/AutomatonGraph.ml[30,1360+56]..src/AutomatonGraph.ml[30,1360+86])
                                  Ttyp_arrow
                                  Labelled "label"
                                  core_type (src/AutomatonGraph.ml[30,1360+62]..src/AutomatonGraph.ml[30,1360+68])
                                    Ttyp_constr "string/15!"
                                    []
                                  core_type (src/AutomatonGraph.ml[30,1360+72]..src/AutomatonGraph.ml[30,1360+86])
                                    Ttyp_arrow
                                    Nolabel
                                    core_type (src/AutomatonGraph.ml[30,1360+72]..src/AutomatonGraph.ml[30,1360+78])
                                      Ttyp_constr "vertex/426"
                                      []
                                    core_type (src/AutomatonGraph.ml[30,1360+82]..src/AutomatonGraph.ml[30,1360+86])
                                      Ttyp_constr "unit/6!"
                                      []
                          Tpat_alias "f/687"
                          pattern (src/AutomatonGraph.ml[30,1360+12]..src/AutomatonGraph.ml[30,1360+13])
                            Tpat_any
                        expression (src/AutomatonGraph.ml[31,1450+4]..src/AutomatonGraph.ml[34,1548+5])
                          Texp_apply
                          expression (src/AutomatonGraph.ml[31,1450+4]..src/AutomatonGraph.ml[31,1450+12])
                            Texp_ident "Dune__exe!.Lr1.iter"
                          [
                            <arg>
                              Nolabel
                              expression (src/AutomatonGraph.ml[31,1450+13]..src/AutomatonGraph.ml[34,1548+5])
                                Texp_function
                                Nolabel
                                [
                                  <case>
                                    pattern (src/AutomatonGraph.ml[31,1450+18]..src/AutomatonGraph.ml[31,1450+22])
                                      Tpat_var "node/688"
                                    expression (src/AutomatonGraph.ml[32,1476+6]..src/AutomatonGraph.ml[33,1528+19])
                                      Texp_let Nonrec
                                      [
                                        <def>
                                          pattern (src/AutomatonGraph.ml[32,1476+10]..src/AutomatonGraph.ml[32,1476+15])
                                            Tpat_var "label/689"
                                          expression (src/AutomatonGraph.ml[32,1476+18]..src/AutomatonGraph.ml[32,1476+48])
                                            Texp_apply
                                            expression (src/AutomatonGraph.ml[32,1476+18]..src/AutomatonGraph.ml[32,1476+25])
                                              Texp_ident "Stdlib!.Printf.sprintf"
                                            [
                                              <arg>
                                                Nolabel
                                                expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30])
                                                  Texp_construct "CamlinternalFormatBasics.Format"
                                                  [
                                                    expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                      Texp_construct "CamlinternalFormatBasics.Int"
                                                      [
                                                        expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                          Texp_construct "CamlinternalFormatBasics.Int_d"
                                                          []
                                                        expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                          Texp_construct "CamlinternalFormatBasics.No_padding"
                                                          []
                                                        expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                          Texp_construct "CamlinternalFormatBasics.No_precision"
                                                          []
                                                        expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                          Texp_construct "CamlinternalFormatBasics.End_of_format"
                                                          []
                                                      ]
                                                    expression (src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost
                                                      Texp_constant Const_string("%d",(src/AutomatonGraph.ml[32,1476+26]..src/AutomatonGraph.ml[32,1476+30]) ghost,None)
                                                  ]
                                              <arg>
                                                Nolabel
                                                expression (src/AutomatonGraph.ml[32,1476+31]..src/AutomatonGraph.ml[32,1476+48])
                                                  Texp_apply
                                                  expression (src/AutomatonGraph.ml[32,1476+32]..src/AutomatonGraph.ml[32,1476+42])
                                                    Texp_ident "Dune__exe!.Lr1.number"
                                                  [
                                                    <arg>
                                                      Nolabel
                                                      expression (src/AutomatonGraph.ml[32,1476+43]..src/AutomatonGraph.ml[32,1476+47])
                                                        Texp_ident "node/688"
                                                  ]
                                            ]
                                      ]
                                      expression (src/AutomatonGraph.ml[33,1528+6]..src/AutomatonGraph.ml[33,1528+19])
                                        Texp_apply
                                        expression (src/AutomatonGraph.ml[33,1528+6]..src/AutomatonGraph.ml[33,1528+7])
                                          Texp_ident "f/687"
                                        [
                                          <arg>
                                            Optional "shape"
                                            expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                                              Texp_construct "None"
                                              []
                                          <arg>
                                            Optional "style"
                                            expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                                              Texp_construct "None"
                                              []
                                          <arg>
                                            Labelled "label"
                                            expression (src/AutomatonGraph.ml[33,1528+9]..src/AutomatonGraph.ml[33,1528+14])
                                              Texp_ident "label/689"
                                          <arg>
                                            Nolabel
                                            expression (src/AutomatonGraph.ml[33,1528+15]..src/AutomatonGraph.ml[33,1528+19])
                                              Texp_ident "node/688"
                                        ]
                                ]
                          ]
                    ]
              ]
          ]
  structure_item (src/AutomatonGraph.ml[38,1561+0]..src/AutomatonGraph.ml[41,1651+13])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/AutomatonGraph.ml[38,1561+4]..src/AutomatonGraph.ml[38,1561+25])
          Tpat_var "print_automaton_graph/706"
        expression (src/AutomatonGraph.ml[38,1561+25]..src/AutomatonGraph.ml[41,1651+13]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/AutomatonGraph.ml[38,1561+25]..src/AutomatonGraph.ml[38,1561+27])
                Tpat_construct "()"
                []
                None
              expression (src/AutomatonGraph.ml[39,1591+2]..src/AutomatonGraph.ml[41,1651+13])
                Texp_let Nonrec
                [
                  <def>
                    pattern (src/AutomatonGraph.ml[39,1591+6]..src/AutomatonGraph.ml[39,1591+7])
                      Tpat_var "f/708"
                    expression (src/AutomatonGraph.ml[39,1591+10]..src/AutomatonGraph.ml[39,1591+43])
                      Texp_apply
                      expression (src/AutomatonGraph.ml[39,1591+10]..src/AutomatonGraph.ml[39,1591+18])
                        Texp_ident "Stdlib!.open_out"
                      [
                        <arg>
                          Nolabel
                          expression (src/AutomatonGraph.ml[39,1591+19]..src/AutomatonGraph.ml[39,1591+43])
                            Texp_apply
                            expression (src/AutomatonGraph.ml[39,1591+34]..src/AutomatonGraph.ml[39,1591+35])
                              Texp_ident "Stdlib!.^"
                            [
                              <arg>
                                Nolabel
                                expression (src/AutomatonGraph.ml[39,1591+20]..src/AutomatonGraph.ml[39,1591+33])
                                  Texp_ident "Dune__exe!.Settings.base"
                              <arg>
                                Nolabel
                                expression (src/AutomatonGraph.ml[39,1591+36]..src/AutomatonGraph.ml[39,1591+42])
                                  Texp_constant Const_string(".dot",(src/AutomatonGraph.ml[39,1591+37]..src/AutomatonGraph.ml[39,1591+41]),None)
                            ]
                      ]
                ]
                expression (src/AutomatonGraph.ml[40,1638+2]..src/AutomatonGraph.ml[41,1651+13])
                  Texp_sequence
                  expression (src/AutomatonGraph.ml[40,1638+2]..src/AutomatonGraph.ml[40,1638+11])
                    Texp_apply
                    expression (src/AutomatonGraph.ml[40,1638+2]..src/AutomatonGraph.ml[40,1638+9])
                      Texp_ident "P/705.print"
                    [
                      <arg>
                        Optional "directed"
                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                          Texp_construct "None"
                          []
                      <arg>
                        Optional "size"
                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                          Texp_construct "None"
                          []
                      <arg>
                        Optional "orientation"
                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                          Texp_construct "None"
                          []
                      <arg>
                        Optional "rankdir"
                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                          Texp_construct "None"
                          []
                      <arg>
                        Optional "ratio"
                        expression (_none_[0,0+-1].._none_[0,0+-1]) ghost
                          Texp_construct "None"
                          []
                      <arg>
                        Nolabel
                        expression (src/AutomatonGraph.ml[40,1638+10]..src/AutomatonGraph.ml[40,1638+11])
                          Texp_ident "f/708"
                    ]
                  expression (src/AutomatonGraph.ml[41,1651+2]..src/AutomatonGraph.ml[41,1651+13])
                    Texp_apply
                    expression (src/AutomatonGraph.ml[41,1651+2]..src/AutomatonGraph.ml[41,1651+11])
                      Texp_ident "Stdlib!.close_out"
                    [
                      <arg>
                        Nolabel
                        expression (src/AutomatonGraph.ml[41,1651+12]..src/AutomatonGraph.ml[41,1651+13])
                          Texp_ident "f/708"
                    ]
          ]
    ]
]

{<Dune__exe__AutomatonGraph>
 "print_automaton_graph"[value] -> <Dune__exe__AutomatonGraph.14>;
 }

(let
  (P/705 =
     (apply
       (let (let/1786 = (field_imm 0 (global Dune__exe__Dot!)))
         (field_imm 0 (global Dune__exe__Dot!)))
       (let
         (name/509 =
            (function node/511
              (apply (field_imm 3 (global Stdlib__Printf!))
                [0: [12: 's' [4: 0 0 0 0]] "s%d"]
                (apply (field_imm 9 (global Dune__exe__Lr1!)) node/511)))
          successors/535 =
            (function f/545 source/546 : int
              (apply
                (field_imm 22 (field_imm 7 (global Dune__exe__Grammar!)))
                (function symbol/612 target/613 : int
                  (let
                    (label/614 =
                       (apply
                         (field_imm 5
                           (field_imm 5 (global Dune__exe__Grammar!)))
                         symbol/612))
                    (apply f/545 0 label/614 target/613)))
                (apply (field_imm 19 (global Dune__exe__Lr1!)) source/546)))
          iter/685 =
            (function f/687 : int
              (apply (field_imm 25 (global Dune__exe__Lr1!))
                (function node/688 : int
                  (let
                    (label/689 =
                       (apply (field_imm 3 (global Stdlib__Printf!))
                         [0: [4: 0 0 0 0] "%d"]
                         (apply (field_imm 9 (global Dune__exe__Lr1!))
                           node/688)))
                    (apply f/687 0 0 label/689 node/688))))))
         (makeblock 0 name/509 successors/535 iter/685))))
  (seq (setfield_ptr(root-init) 1 (global Dune__exe__AutomatonGraph!) P/705)
    (let
      (print_automaton_graph/706 =
         (function param/769[int] : int
           (let
             (f/708 =
                (apply (field_imm 59 (global Stdlib!))
                  (apply (field_imm 27 (global Stdlib!))
                    (field_imm 24 (global Dune__exe__Settings!)) ".dot")))
             (seq
               (apply
                 (field_imm 0
                   (field_imm 1 (global Dune__exe__AutomatonGraph!)))
                 0 0 0 0 0 f/708)
               (apply (field_imm 75 (global Stdlib!)) f/708)))))
      (setfield_ptr(root-init) 0 (global Dune__exe__AutomatonGraph!)
        print_automaton_graph/706))
    0))
(let
  (P/705 =
     (apply
       (let (let/1786 = (field_imm 0 (global Dune__exe__Dot!)))
         (field_imm 0 (global Dune__exe__Dot!)))
       (let
         (name/509 =
            (function node/511
              (apply (field_imm 3 (global Stdlib__Printf!))
                [0: [12: 's' [4: 0 0 0 0]] "s%d"]
                (apply (field_imm 9 (global Dune__exe__Lr1!)) node/511)))
          successors/535 =
            (function f/545 source/546 : int
              (apply
                (field_imm 22 (field_imm 7 (global Dune__exe__Grammar!)))
                (function symbol/612 target/613 : int
                  (let
                    (label/614 =
                       (apply
                         (field_imm 5
                           (field_imm 5 (global Dune__exe__Grammar!)))
                         symbol/612))
                    (apply f/545 0 label/614 target/613)))
                (apply (field_imm 19 (global Dune__exe__Lr1!)) source/546)))
          iter/685 =
            (function f/687 : int
              (apply (field_imm 25 (global Dune__exe__Lr1!))
                (function node/688 : int
                  (let
                    (label/689 =
                       (apply (field_imm 3 (global Stdlib__Printf!))
                         [0: [4: 0 0 0 0] "%d"]
                         (apply (field_imm 9 (global Dune__exe__Lr1!))
                           node/688)))
                    (apply f/687 0 0 label/689 node/688))))))
         (makeblock 0 name/509 successors/535 iter/685))))
  (seq (setfield_ptr(root-init) 1 (global Dune__exe__AutomatonGraph!) P/705)
    (let
      (print_automaton_graph/706 =
         (function param/769[int] : int
           (let
             (f/708 =
                (apply (field_imm 59 (global Stdlib!))
                  (apply (field_imm 27 (global Stdlib!))
                    (field_imm 24 (global Dune__exe__Settings!)) ".dot")))
             (seq
               (apply
                 (field_imm 0
                   (field_imm 1 (global Dune__exe__AutomatonGraph!)))
                 0 0 0 0 0 f/708)
               (apply (field_imm 75 (global Stdlib!)) f/708)))))
      (setfield_ptr(root-init) 0 (global Dune__exe__AutomatonGraph!)
        print_automaton_graph/706))
    0))
