[
  structure_item (src/expandTokenAliases.ml[14,1008+0]..[14,1008+11])
    Pstr_open Fresh
    module_expr (src/expandTokenAliases.ml[14,1008+5]..[14,1008+11])
      Pmod_ident "Syntax" (src/expandTokenAliases.ml[14,1008+5]..[14,1008+11])
  structure_item (src/expandTokenAliases.ml[22,1344+0]..[23,1360+38])
    Pstr_type Rec
    [
      type_declaration "aliasmap" (src/expandTokenAliases.ml[22,1344+5]..[22,1344+13]) (src/expandTokenAliases.ml[22,1344+0]..[23,1360+38])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (src/expandTokenAliases.ml[23,1360+2]..[23,1360+38])
              Ptyp_constr "StringMap.t" (src/expandTokenAliases.ml[23,1360+27]..[23,1360+38])
              [
                core_type (src/expandTokenAliases.ml[23,1360+3]..[23,1360+25])
                  Ptyp_tuple
                  [
                    core_type (src/expandTokenAliases.ml[23,1360+3]..[23,1360+11])
                      Ptyp_constr "terminal" (src/expandTokenAliases.ml[23,1360+3]..[23,1360+11])
                      []
                    core_type (src/expandTokenAliases.ml[23,1360+14]..[23,1360+25])
                      Ptyp_constr "Positions.t" (src/expandTokenAliases.ml[23,1360+14]..[23,1360+25])
                      []
                  ]
              ]
    ]
  structure_item (src/expandTokenAliases.ml[29,1558+0]..[46,2277+14])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[29,1558+4]..[29,1558+36])
          Ppat_var "collect_aliases_from_declaration" (src/expandTokenAliases.ml[29,1558+4]..[29,1558+36])
        expression (src/expandTokenAliases.ml[29,1558+37]..[46,2277+14]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[29,1558+37]..[29,1558+58])
            Ppat_constraint
            pattern (src/expandTokenAliases.ml[29,1558+38]..[29,1558+46])
              Ppat_var "aliasmap" (src/expandTokenAliases.ml[29,1558+38]..[29,1558+46])
            core_type (src/expandTokenAliases.ml[29,1558+49]..[29,1558+57])
              Ptyp_constr "aliasmap" (src/expandTokenAliases.ml[29,1558+49]..[29,1558+57])
              []
          expression (src/expandTokenAliases.ml[29,1558+59]..[46,2277+14]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[29,1558+59]..[29,1558+63])
              Ppat_var "decl" (src/expandTokenAliases.ml[29,1558+59]..[29,1558+63])
            expression (src/expandTokenAliases.ml[29,1558+64]..[46,2277+14])
              Pexp_constraint
              expression (src/expandTokenAliases.ml[30,1635+2]..[46,2277+14])
                Pexp_match
                expression (src/expandTokenAliases.ml[30,1635+8]..[30,1635+28])
                  Pexp_apply
                  expression (src/expandTokenAliases.ml[30,1635+8]..[30,1635+23])
                    Pexp_ident "Positions.value" (src/expandTokenAliases.ml[30,1635+8]..[30,1635+23])
                  [
                    <arg>
                    Nolabel
                      expression (src/expandTokenAliases.ml[30,1635+24]..[30,1635+28])
                        Pexp_ident "decl" (src/expandTokenAliases.ml[30,1635+24]..[30,1635+28])
                  ]
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[31,1669+4]..[31,1669+31])
                      Ppat_construct "DToken" (src/expandTokenAliases.ml[31,1669+4]..[31,1669+10])
                      Some
                        []
                        pattern (src/expandTokenAliases.ml[31,1669+11]..[31,1669+31])
                          Ppat_tuple
                          [
                            pattern (src/expandTokenAliases.ml[31,1669+12]..[31,1669+13])
                              Ppat_any
                            pattern (src/expandTokenAliases.ml[31,1669+15]..[31,1669+17])
                              Ppat_var "id" (src/expandTokenAliases.ml[31,1669+15]..[31,1669+17])
                            pattern (src/expandTokenAliases.ml[31,1669+19]..[31,1669+27])
                              Ppat_construct "Some" (src/expandTokenAliases.ml[31,1669+19]..[31,1669+23])
                              Some
                                []
                                pattern (src/expandTokenAliases.ml[31,1669+24]..[31,1669+27])
                                  Ppat_var "qid" (src/expandTokenAliases.ml[31,1669+24]..[31,1669+27])
                            pattern (src/expandTokenAliases.ml[31,1669+29]..[31,1669+30])
                              Ppat_any
                          ]
                    expression (src/expandTokenAliases.ml[32,1704+6]..[44,2258+9])
                      Pexp_match
                      expression (src/expandTokenAliases.ml[32,1704+18]..[32,1704+45])
                        Pexp_apply
                        expression (src/expandTokenAliases.ml[32,1704+18]..[32,1704+32])
                          Pexp_ident "StringMap.find" (src/expandTokenAliases.ml[32,1704+18]..[32,1704+32])
                        [
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[32,1704+33]..[32,1704+36])
                              Pexp_ident "qid" (src/expandTokenAliases.ml[32,1704+33]..[32,1704+36])
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[32,1704+37]..[32,1704+45])
                              Pexp_ident "aliasmap" (src/expandTokenAliases.ml[32,1704+37]..[32,1704+45])
                        ]
                      [
                        <case>
                          pattern (src/expandTokenAliases.ml[33,1755+8]..[33,1755+27])
                            Ppat_exception
                            pattern (src/expandTokenAliases.ml[33,1755+18]..[33,1755+27])
                              Ppat_construct "Not_found" (src/expandTokenAliases.ml[33,1755+18]..[33,1755+27])
                              None
                          expression (src/expandTokenAliases.ml[35,1850+10]..[35,1850+66])
                            Pexp_apply
                            expression (src/expandTokenAliases.ml[35,1850+10]..[35,1850+23])
                              Pexp_ident "StringMap.add" (src/expandTokenAliases.ml[35,1850+10]..[35,1850+23])
                            [
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[35,1850+24]..[35,1850+27])
                                  Pexp_ident "qid" (src/expandTokenAliases.ml[35,1850+24]..[35,1850+27])
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[35,1850+28]..[35,1850+57])
                                  Pexp_tuple
                                  [
                                    expression (src/expandTokenAliases.ml[35,1850+29]..[35,1850+31])
                                      Pexp_ident "id" (src/expandTokenAliases.ml[35,1850+29]..[35,1850+31])
                                    expression (src/expandTokenAliases.ml[35,1850+33]..[35,1850+56])
                                      Pexp_apply
                                      expression (src/expandTokenAliases.ml[35,1850+33]..[35,1850+51])
                                        Pexp_ident "Positions.position" (src/expandTokenAliases.ml[35,1850+33]..[35,1850+51])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[35,1850+52]..[35,1850+56])
                                            Pexp_ident "decl" (src/expandTokenAliases.ml[35,1850+52]..[35,1850+56])
                                      ]
                                  ]
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[35,1850+58]..[35,1850+66])
                                  Pexp_ident "aliasmap" (src/expandTokenAliases.ml[35,1850+58]..[35,1850+66])
                            ]
                        <case>
                          pattern (src/expandTokenAliases.ml[36,1917+8]..[36,1917+16])
                            Ppat_tuple
                            [
                              pattern (src/expandTokenAliases.ml[36,1917+8]..[36,1917+11])
                                Ppat_var "id0" (src/expandTokenAliases.ml[36,1917+8]..[36,1917+11])
                              pattern (src/expandTokenAliases.ml[36,1917+13]..[36,1917+16])
                                Ppat_var "pos" (src/expandTokenAliases.ml[36,1917+13]..[36,1917+16])
                            ]
                          expression (src/expandTokenAliases.ml[39,2038+10]..[43,2235+22])
                            Pexp_apply
                            expression (src/expandTokenAliases.ml[39,2038+10]..[39,2038+21])
                              Pexp_ident "Error.error" (src/expandTokenAliases.ml[39,2038+10]..[39,2038+21])
                            [
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[40,2060+12]..[40,2060+42])
                                  Pexp_construct "::" (src/expandTokenAliases.ml[40,2060+13]..[40,2060+42]) ghost
                                  Some
                                    expression (src/expandTokenAliases.ml[40,2060+13]..[40,2060+42]) ghost
                                      Pexp_tuple
                                      [
                                        expression (src/expandTokenAliases.ml[40,2060+13]..[40,2060+36])
                                          Pexp_apply
                                          expression (src/expandTokenAliases.ml[40,2060+13]..[40,2060+31])
                                            Pexp_ident "Positions.position" (src/expandTokenAliases.ml[40,2060+13]..[40,2060+31])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (src/expandTokenAliases.ml[40,2060+32]..[40,2060+36])
                                                Pexp_ident "decl" (src/expandTokenAliases.ml[40,2060+32]..[40,2060+36])
                                          ]
                                        expression (src/expandTokenAliases.ml[40,2060+38]..[40,2060+42]) ghost
                                          Pexp_construct "::" (src/expandTokenAliases.ml[40,2060+38]..[40,2060+42]) ghost
                                          Some
                                            expression (src/expandTokenAliases.ml[40,2060+38]..[40,2060+42]) ghost
                                              Pexp_tuple
                                              [
                                                expression (src/expandTokenAliases.ml[40,2060+38]..[40,2060+41])
                                                  Pexp_ident "pos" (src/expandTokenAliases.ml[40,2060+38]..[40,2060+41])
                                                expression (src/expandTokenAliases.ml[40,2060+41]..[40,2060+42]) ghost
                                                  Pexp_construct "[]" (src/expandTokenAliases.ml[40,2060+41]..[40,2060+42]) ghost
                                                  None
                                              ]
                                      ]
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[41,2103+12]..[42,2172+62])
                                  Pexp_constant PConst_string("%s cannot be declared as an alias for the symbol %s.\nIt has already been declared as an alias for %s.",(src/expandTokenAliases.ml[41,2103+13]..[42,2172+61]),None)
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[43,2235+12]..[43,2235+15])
                                  Pexp_ident "qid" (src/expandTokenAliases.ml[43,2235+12]..[43,2235+15])
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[43,2235+16]..[43,2235+18])
                                  Pexp_ident "id" (src/expandTokenAliases.ml[43,2235+16]..[43,2235+18])
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[43,2235+19]..[43,2235+22])
                                  Pexp_ident "id0" (src/expandTokenAliases.ml[43,2235+19]..[43,2235+22])
                            ]
                      ]
                  <case>
                    pattern (src/expandTokenAliases.ml[45,2268+4]..[45,2268+5])
                      Ppat_any
                    expression (src/expandTokenAliases.ml[46,2277+6]..[46,2277+14])
                      Pexp_ident "aliasmap" (src/expandTokenAliases.ml[46,2277+6]..[46,2277+14])
                ]
              core_type (src/expandTokenAliases.ml[29,1558+66]..[29,1558+74])
                Ptyp_constr "aliasmap" (src/expandTokenAliases.ml[29,1558+66]..[29,1558+74])
                []
    ]
  structure_item (src/expandTokenAliases.ml[50,2373+0]..[51,2419+76])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[50,2373+4]..[50,2373+32])
          Ppat_var "collect_aliases_from_grammar" (src/expandTokenAliases.ml[50,2373+4]..[50,2373+32])
        expression (src/expandTokenAliases.ml[50,2373+33]..[51,2419+76]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[50,2373+33]..[50,2373+41])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[50,2373+33]..[50,2373+41])
          expression (src/expandTokenAliases.ml[50,2373+42]..[51,2419+76]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[50,2373+42]..[50,2373+43])
              Ppat_var "g" (src/expandTokenAliases.ml[50,2373+42]..[50,2373+43])
            expression (src/expandTokenAliases.ml[51,2419+2]..[51,2419+76])
              Pexp_apply
              expression (src/expandTokenAliases.ml[51,2419+2]..[51,2419+16])
                Pexp_ident "List.fold_left" (src/expandTokenAliases.ml[51,2419+2]..[51,2419+16])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[51,2419+17]..[51,2419+49])
                    Pexp_ident "collect_aliases_from_declaration" (src/expandTokenAliases.ml[51,2419+17]..[51,2419+49])
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[51,2419+50]..[51,2419+58])
                    Pexp_ident "aliasmap" (src/expandTokenAliases.ml[51,2419+50]..[51,2419+58])
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[51,2419+59]..[51,2419+76])
                    Pexp_field
                    expression (src/expandTokenAliases.ml[51,2419+59]..[51,2419+60])
                      Pexp_ident "g" (src/expandTokenAliases.ml[51,2419+59]..[51,2419+60])
                    "pg_declarations" (src/expandTokenAliases.ml[51,2419+61]..[51,2419+76])
              ]
    ]
  structure_item (src/expandTokenAliases.ml[53,2497+0]..[54,2547+64])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[53,2497+4]..[53,2497+33])
          Ppat_var "collect_aliases_from_grammars" (src/expandTokenAliases.ml[53,2497+4]..[53,2497+33])
        expression (src/expandTokenAliases.ml[53,2497+34]..[54,2547+64]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[53,2497+34]..[53,2497+36])
            Ppat_var "gs" (src/expandTokenAliases.ml[53,2497+34]..[53,2497+36])
          expression (src/expandTokenAliases.ml[53,2497+37]..[54,2547+64])
            Pexp_constraint
            expression (src/expandTokenAliases.ml[54,2547+2]..[54,2547+64])
              Pexp_apply
              expression (src/expandTokenAliases.ml[54,2547+2]..[54,2547+16])
                Pexp_ident "List.fold_left" (src/expandTokenAliases.ml[54,2547+2]..[54,2547+16])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[54,2547+17]..[54,2547+45])
                    Pexp_ident "collect_aliases_from_grammar" (src/expandTokenAliases.ml[54,2547+17]..[54,2547+45])
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[54,2547+46]..[54,2547+61])
                    Pexp_ident "StringMap.empty" (src/expandTokenAliases.ml[54,2547+46]..[54,2547+61])
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[54,2547+62]..[54,2547+64])
                    Pexp_ident "gs" (src/expandTokenAliases.ml[54,2547+62]..[54,2547+64])
              ]
            core_type (src/expandTokenAliases.ml[53,2497+39]..[53,2497+47])
              Ptyp_constr "aliasmap" (src/expandTokenAliases.ml[53,2497+39]..[53,2497+47])
              []
    ]
  structure_item (src/expandTokenAliases.ml[61,2829+0]..[73,3244+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[61,2829+4]..[61,2829+20])
          Ppat_var "dealias_terminal" (src/expandTokenAliases.ml[61,2829+4]..[61,2829+20])
        expression (src/expandTokenAliases.ml[61,2829+21]..[73,3244+5]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[61,2829+21]..[61,2829+42])
            Ppat_constraint
            pattern (src/expandTokenAliases.ml[61,2829+22]..[61,2829+30])
              Ppat_var "aliasmap" (src/expandTokenAliases.ml[61,2829+22]..[61,2829+30])
            core_type (src/expandTokenAliases.ml[61,2829+33]..[61,2829+41])
              Ptyp_constr "aliasmap" (src/expandTokenAliases.ml[61,2829+33]..[61,2829+41])
              []
          expression (src/expandTokenAliases.ml[61,2829+43]..[73,3244+5]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[61,2829+43]..[61,2829+46])
              Ppat_var "pos" (src/expandTokenAliases.ml[61,2829+43]..[61,2829+46])
            expression (src/expandTokenAliases.ml[61,2829+47]..[73,3244+5]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (src/expandTokenAliases.ml[61,2829+47]..[61,2829+61])
                Ppat_constraint
                pattern (src/expandTokenAliases.ml[61,2829+48]..[61,2829+49])
                  Ppat_var "t" (src/expandTokenAliases.ml[61,2829+48]..[61,2829+49])
                core_type (src/expandTokenAliases.ml[61,2829+52]..[61,2829+60])
                  Ptyp_constr "terminal" (src/expandTokenAliases.ml[61,2829+52]..[61,2829+60])
                  []
              expression (src/expandTokenAliases.ml[61,2829+62]..[73,3244+5])
                Pexp_constraint
                expression (src/expandTokenAliases.ml[64,3030+2]..[73,3244+5])
                  Pexp_ifthenelse
                  expression (src/expandTokenAliases.ml[64,3030+5]..[64,3030+16])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[64,3030+11]..[64,3030+12])
                      Pexp_ident "=" (src/expandTokenAliases.ml[64,3030+11]..[64,3030+12])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[64,3030+5]..[64,3030+10])
                          Pexp_apply
                          expression (src/expandTokenAliases.ml[64,3030+5]..[64,3030+10]) ghost
                            Pexp_ident "String.get" (src/expandTokenAliases.ml[64,3030+5]..[64,3030+10]) ghost
                          [
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[64,3030+5]..[64,3030+6])
                                Pexp_ident "t" (src/expandTokenAliases.ml[64,3030+5]..[64,3030+6])
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[64,3030+8]..[64,3030+9])
                                Pexp_constant PConst_int (0,None)
                          ]
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[64,3030+13]..[64,3030+16])
                          Pexp_constant PConst_char 22
                    ]
                  expression (src/expandTokenAliases.ml[65,3052+4]..[71,3184+52])
                    Pexp_match
                    expression (src/expandTokenAliases.ml[65,3052+10]..[65,3052+35])
                      Pexp_apply
                      expression (src/expandTokenAliases.ml[65,3052+10]..[65,3052+24])
                        Pexp_ident "StringMap.find" (src/expandTokenAliases.ml[65,3052+10]..[65,3052+24])
                      [
                        <arg>
                        Nolabel
                          expression (src/expandTokenAliases.ml[65,3052+25]..[65,3052+26])
                            Pexp_ident "t" (src/expandTokenAliases.ml[65,3052+25]..[65,3052+26])
                        <arg>
                        Nolabel
                          expression (src/expandTokenAliases.ml[65,3052+27]..[65,3052+35])
                            Pexp_ident "aliasmap" (src/expandTokenAliases.ml[65,3052+27]..[65,3052+35])
                      ]
                    [
                      <case>
                        pattern (src/expandTokenAliases.ml[66,3093+6]..[66,3093+11])
                          Ppat_tuple
                          [
                            pattern (src/expandTokenAliases.ml[66,3093+6]..[66,3093+8])
                              Ppat_var "id" (src/expandTokenAliases.ml[66,3093+6]..[66,3093+8])
                            pattern (src/expandTokenAliases.ml[66,3093+10]..[66,3093+11])
                              Ppat_any
                          ]
                        expression (src/expandTokenAliases.ml[67,3108+8]..[67,3108+10])
                          Pexp_ident "id" (src/expandTokenAliases.ml[67,3108+8]..[67,3108+10])
                      <case>
                        pattern (src/expandTokenAliases.ml[68,3119+6]..[68,3119+25])
                          Ppat_exception
                          pattern (src/expandTokenAliases.ml[68,3119+16]..[68,3119+25])
                            Ppat_construct "Not_found" (src/expandTokenAliases.ml[68,3119+16]..[68,3119+25])
                            None
                        expression (src/expandTokenAliases.ml[69,3148+8]..[71,3184+52])
                          Pexp_apply
                          expression (src/expandTokenAliases.ml[69,3148+8]..[69,3148+19])
                            Pexp_ident "Error.error" (src/expandTokenAliases.ml[69,3148+8]..[69,3148+19])
                          [
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[70,3168+10]..[70,3168+15])
                                Pexp_construct "::" (src/expandTokenAliases.ml[70,3168+11]..[70,3168+15]) ghost
                                Some
                                  expression (src/expandTokenAliases.ml[70,3168+11]..[70,3168+15]) ghost
                                    Pexp_tuple
                                    [
                                      expression (src/expandTokenAliases.ml[70,3168+11]..[70,3168+14])
                                        Pexp_ident "pos" (src/expandTokenAliases.ml[70,3168+11]..[70,3168+14])
                                      expression (src/expandTokenAliases.ml[70,3168+14]..[70,3168+15]) ghost
                                        Pexp_construct "[]" (src/expandTokenAliases.ml[70,3168+14]..[70,3168+15]) ghost
                                        None
                                    ]
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[71,3184+10]..[71,3184+50])
                                Pexp_constant PConst_string("the token alias %s was never declared.",(src/expandTokenAliases.ml[71,3184+11]..[71,3184+49]),None)
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[71,3184+51]..[71,3184+52])
                                Pexp_ident "t" (src/expandTokenAliases.ml[71,3184+51]..[71,3184+52])
                          ]
                    ]
                  Some
                    expression (src/expandTokenAliases.ml[73,3244+4]..[73,3244+5])
                      Pexp_ident "t" (src/expandTokenAliases.ml[73,3244+4]..[73,3244+5])
                core_type (src/expandTokenAliases.ml[61,2829+64]..[61,2829+72])
                  Ptyp_constr "terminal" (src/expandTokenAliases.ml[61,2829+64]..[61,2829+72])
                  []
    ]
  structure_item (src/expandTokenAliases.ml[78,3348+0]..[79,3413+48])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[78,3348+4]..[78,3348+18])
          Ppat_var "dealias_symbol" (src/expandTokenAliases.ml[78,3348+4]..[78,3348+18])
        expression (src/expandTokenAliases.ml[78,3348+19]..[79,3413+48]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[78,3348+19]..[78,3348+27])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[78,3348+19]..[78,3348+27])
          expression (src/expandTokenAliases.ml[78,3348+28]..[79,3413+48]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[78,3348+28]..[78,3348+62])
              Ppat_constraint
              pattern (src/expandTokenAliases.ml[78,3348+29]..[78,3348+32])
                Ppat_var "sym" (src/expandTokenAliases.ml[78,3348+29]..[78,3348+32])
              core_type (src/expandTokenAliases.ml[78,3348+35]..[78,3348+61])
                Ptyp_constr "Positions.located" (src/expandTokenAliases.ml[78,3348+44]..[78,3348+61])
                [
                  core_type (src/expandTokenAliases.ml[78,3348+35]..[78,3348+43])
                    Ptyp_constr "terminal" (src/expandTokenAliases.ml[78,3348+35]..[78,3348+43])
                    []
                ]
            expression (src/expandTokenAliases.ml[79,3413+2]..[79,3413+48])
              Pexp_apply
              expression (src/expandTokenAliases.ml[79,3413+2]..[79,3413+16])
                Pexp_ident "Positions.pmap" (src/expandTokenAliases.ml[79,3413+2]..[79,3413+16])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[79,3413+17]..[79,3413+44])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[79,3413+18]..[79,3413+34])
                      Pexp_ident "dealias_terminal" (src/expandTokenAliases.ml[79,3413+18]..[79,3413+34])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[79,3413+35]..[79,3413+43])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[79,3413+35]..[79,3413+43])
                    ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[79,3413+45]..[79,3413+48])
                    Pexp_ident "sym" (src/expandTokenAliases.ml[79,3413+45]..[79,3413+48])
              ]
    ]
  structure_item (src/expandTokenAliases.ml[81,3463+0]..[107,4375+45])
    Pstr_value Rec
    [
      <def>
        pattern (src/expandTokenAliases.ml[81,3463+8]..[81,3463+25])
          Ppat_var "dealias_parameter" (src/expandTokenAliases.ml[81,3463+8]..[81,3463+25])
        expression (src/expandTokenAliases.ml[81,3463+26]..[91,3790+77]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[81,3463+26]..[81,3463+34])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[81,3463+26]..[81,3463+34])
          expression (src/expandTokenAliases.ml[81,3463+35]..[91,3790+77]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[81,3463+35]..[81,3463+54])
              Ppat_constraint
              pattern (src/expandTokenAliases.ml[81,3463+36]..[81,3463+41])
                Ppat_var "param" (src/expandTokenAliases.ml[81,3463+36]..[81,3463+41])
              core_type (src/expandTokenAliases.ml[81,3463+44]..[81,3463+53])
                Ptyp_constr "parameter" (src/expandTokenAliases.ml[81,3463+44]..[81,3463+53])
                []
            expression (src/expandTokenAliases.ml[82,3520+2]..[91,3790+77])
              Pexp_match
              expression (src/expandTokenAliases.ml[82,3520+8]..[82,3520+13])
                Pexp_ident "param" (src/expandTokenAliases.ml[82,3520+8]..[82,3520+13])
              [
                <case>
                  pattern (src/expandTokenAliases.ml[83,3539+4]..[83,3539+20])
                    Ppat_construct "ParameterVar" (src/expandTokenAliases.ml[83,3539+4]..[83,3539+16])
                    Some
                      []
                      pattern (src/expandTokenAliases.ml[83,3539+17]..[83,3539+20])
                        Ppat_var "sym" (src/expandTokenAliases.ml[83,3539+17]..[83,3539+20])
                  expression (src/expandTokenAliases.ml[84,3563+6]..[84,3563+48])
                    Pexp_construct "ParameterVar" (src/expandTokenAliases.ml[84,3563+6]..[84,3563+18])
                    Some
                      expression (src/expandTokenAliases.ml[84,3563+19]..[84,3563+48])
                        Pexp_apply
                        expression (src/expandTokenAliases.ml[84,3563+20]..[84,3563+34])
                          Pexp_ident "dealias_symbol" (src/expandTokenAliases.ml[84,3563+20]..[84,3563+34])
                        [
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[84,3563+35]..[84,3563+43])
                              Pexp_ident "aliasmap" (src/expandTokenAliases.ml[84,3563+35]..[84,3563+43])
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[84,3563+44]..[84,3563+47])
                              Pexp_ident "sym" (src/expandTokenAliases.ml[84,3563+44]..[84,3563+47])
                        ]
                <case>
                  pattern (src/expandTokenAliases.ml[85,3612+4]..[85,3612+30])
                    Ppat_construct "ParameterApp" (src/expandTokenAliases.ml[85,3612+4]..[85,3612+16])
                    Some
                      []
                      pattern (src/expandTokenAliases.ml[85,3612+17]..[85,3612+30])
                        Ppat_tuple
                        [
                          pattern (src/expandTokenAliases.ml[85,3612+18]..[85,3612+21])
                            Ppat_var "sym" (src/expandTokenAliases.ml[85,3612+18]..[85,3612+21])
                          pattern (src/expandTokenAliases.ml[85,3612+23]..[85,3612+29])
                            Ppat_var "params" (src/expandTokenAliases.ml[85,3612+23]..[85,3612+29])
                        ]
                  expression (src/expandTokenAliases.ml[86,3646+6]..[89,3747+7])
                    Pexp_construct "ParameterApp" (src/expandTokenAliases.ml[86,3646+6]..[86,3646+18])
                    Some
                      expression (src/expandTokenAliases.ml[86,3646+19]..[89,3747+7])
                        Pexp_tuple
                        [
                          expression (src/expandTokenAliases.ml[87,3667+8]..[87,3667+35])
                            Pexp_apply
                            expression (src/expandTokenAliases.ml[87,3667+8]..[87,3667+22])
                              Pexp_ident "dealias_symbol" (src/expandTokenAliases.ml[87,3667+8]..[87,3667+22])
                            [
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[87,3667+23]..[87,3667+31])
                                  Pexp_ident "aliasmap" (src/expandTokenAliases.ml[87,3667+23]..[87,3667+31])
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[87,3667+32]..[87,3667+35])
                                  Pexp_ident "sym" (src/expandTokenAliases.ml[87,3667+32]..[87,3667+35])
                            ]
                          expression (src/expandTokenAliases.ml[88,3704+8]..[88,3704+42])
                            Pexp_apply
                            expression (src/expandTokenAliases.ml[88,3704+8]..[88,3704+26])
                              Pexp_ident "dealias_parameters" (src/expandTokenAliases.ml[88,3704+8]..[88,3704+26])
                            [
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[88,3704+27]..[88,3704+35])
                                  Pexp_ident "aliasmap" (src/expandTokenAliases.ml[88,3704+27]..[88,3704+35])
                              <arg>
                              Nolabel
                                expression (src/expandTokenAliases.ml[88,3704+36]..[88,3704+42])
                                  Pexp_ident "params" (src/expandTokenAliases.ml[88,3704+36]..[88,3704+42])
                            ]
                        ]
                <case>
                  pattern (src/expandTokenAliases.ml[90,3755+4]..[90,3755+31])
                    Ppat_construct "ParameterAnonymous" (src/expandTokenAliases.ml[90,3755+4]..[90,3755+22])
                    Some
                      []
                      pattern (src/expandTokenAliases.ml[90,3755+23]..[90,3755+31])
                        Ppat_var "branches" (src/expandTokenAliases.ml[90,3755+23]..[90,3755+31])
                  expression (src/expandTokenAliases.ml[91,3790+6]..[91,3790+77])
                    Pexp_construct "ParameterAnonymous" (src/expandTokenAliases.ml[91,3790+6]..[91,3790+24])
                    Some
                      expression (src/expandTokenAliases.ml[91,3790+25]..[91,3790+77])
                        Pexp_apply
                        expression (src/expandTokenAliases.ml[91,3790+26]..[91,3790+39])
                          Pexp_ident "Positions.map" (src/expandTokenAliases.ml[91,3790+26]..[91,3790+39])
                        [
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[91,3790+40]..[91,3790+67])
                              Pexp_apply
                              expression (src/expandTokenAliases.ml[91,3790+41]..[91,3790+57])
                                Pexp_ident "dealias_branches" (src/expandTokenAliases.ml[91,3790+41]..[91,3790+57])
                              [
                                <arg>
                                Nolabel
                                  expression (src/expandTokenAliases.ml[91,3790+58]..[91,3790+66])
                                    Pexp_ident "aliasmap" (src/expandTokenAliases.ml[91,3790+58]..[91,3790+66])
                              ]
                          <arg>
                          Nolabel
                            expression (src/expandTokenAliases.ml[91,3790+68]..[91,3790+76])
                              Pexp_ident "branches" (src/expandTokenAliases.ml[91,3790+68]..[91,3790+76])
                        ]
              ]
      <def>
        pattern (src/expandTokenAliases.ml[93,3869+4]..[93,3869+22])
          Ppat_var "dealias_parameters" (src/expandTokenAliases.ml[93,3869+4]..[93,3869+22])
        expression (src/expandTokenAliases.ml[93,3869+23]..[94,3910+46]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[93,3869+23]..[93,3869+31])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[93,3869+23]..[93,3869+31])
          expression (src/expandTokenAliases.ml[93,3869+32]..[94,3910+46]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[93,3869+32]..[93,3869+38])
              Ppat_var "params" (src/expandTokenAliases.ml[93,3869+32]..[93,3869+38])
            expression (src/expandTokenAliases.ml[94,3910+2]..[94,3910+46])
              Pexp_apply
              expression (src/expandTokenAliases.ml[94,3910+2]..[94,3910+10])
                Pexp_ident "List.map" (src/expandTokenAliases.ml[94,3910+2]..[94,3910+10])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[94,3910+11]..[94,3910+39])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[94,3910+12]..[94,3910+29])
                      Pexp_ident "dealias_parameter" (src/expandTokenAliases.ml[94,3910+12]..[94,3910+29])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[94,3910+30]..[94,3910+38])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[94,3910+30]..[94,3910+38])
                    ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[94,3910+40]..[94,3910+46])
                    Pexp_ident "params" (src/expandTokenAliases.ml[94,3910+40]..[94,3910+46])
              ]
      <def>
        pattern (src/expandTokenAliases.ml[96,3958+4]..[96,3958+20])
          Ppat_var "dealias_producer" (src/expandTokenAliases.ml[96,3958+4]..[96,3958+20])
        expression (src/expandTokenAliases.ml[96,3958+21]..[98,4049+47]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[96,3958+21]..[96,3958+29])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[96,3958+21]..[96,3958+29])
          expression (src/expandTokenAliases.ml[96,3958+30]..[98,4049+47]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[96,3958+30]..[96,3958+51])
              Ppat_constraint
              pattern (src/expandTokenAliases.ml[96,3958+31]..[96,3958+39])
                Ppat_var "producer" (src/expandTokenAliases.ml[96,3958+31]..[96,3958+39])
              core_type (src/expandTokenAliases.ml[96,3958+42]..[96,3958+50])
                Ptyp_constr "producer" (src/expandTokenAliases.ml[96,3958+42]..[96,3958+50])
                []
            expression (src/expandTokenAliases.ml[97,4012+2]..[98,4049+47])
              Pexp_let Nonrec
              [
                <def>
                  pattern (src/expandTokenAliases.ml[97,4012+6]..[97,4012+22])
                    Ppat_tuple
                    [
                      pattern (src/expandTokenAliases.ml[97,4012+6]..[97,4012+8])
                        Ppat_var "id" (src/expandTokenAliases.ml[97,4012+6]..[97,4012+8])
                      pattern (src/expandTokenAliases.ml[97,4012+10]..[97,4012+15])
                        Ppat_var "param" (src/expandTokenAliases.ml[97,4012+10]..[97,4012+15])
                      pattern (src/expandTokenAliases.ml[97,4012+17]..[97,4012+22])
                        Ppat_var "attrs" (src/expandTokenAliases.ml[97,4012+17]..[97,4012+22])
                    ]
                  expression (src/expandTokenAliases.ml[97,4012+25]..[97,4012+33])
                    Pexp_ident "producer" (src/expandTokenAliases.ml[97,4012+25]..[97,4012+33])
              ]
              expression (src/expandTokenAliases.ml[98,4049+2]..[98,4049+47])
                Pexp_tuple
                [
                  expression (src/expandTokenAliases.ml[98,4049+2]..[98,4049+4])
                    Pexp_ident "id" (src/expandTokenAliases.ml[98,4049+2]..[98,4049+4])
                  expression (src/expandTokenAliases.ml[98,4049+6]..[98,4049+40])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[98,4049+7]..[98,4049+24])
                      Pexp_ident "dealias_parameter" (src/expandTokenAliases.ml[98,4049+7]..[98,4049+24])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[98,4049+25]..[98,4049+33])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[98,4049+25]..[98,4049+33])
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[98,4049+34]..[98,4049+39])
                          Pexp_ident "param" (src/expandTokenAliases.ml[98,4049+34]..[98,4049+39])
                    ]
                  expression (src/expandTokenAliases.ml[98,4049+42]..[98,4049+47])
                    Pexp_ident "attrs" (src/expandTokenAliases.ml[98,4049+42]..[98,4049+47])
                ]
      <def>
        pattern (src/expandTokenAliases.ml[100,4098+4]..[100,4098+21])
          Ppat_var "dealias_producers" (src/expandTokenAliases.ml[100,4098+4]..[100,4098+21])
        expression (src/expandTokenAliases.ml[100,4098+22]..[101,4141+48]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[100,4098+22]..[100,4098+30])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[100,4098+22]..[100,4098+30])
          expression (src/expandTokenAliases.ml[100,4098+31]..[101,4141+48]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[100,4098+31]..[100,4098+40])
              Ppat_var "producers" (src/expandTokenAliases.ml[100,4098+31]..[100,4098+40])
            expression (src/expandTokenAliases.ml[101,4141+2]..[101,4141+48])
              Pexp_apply
              expression (src/expandTokenAliases.ml[101,4141+2]..[101,4141+10])
                Pexp_ident "List.map" (src/expandTokenAliases.ml[101,4141+2]..[101,4141+10])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[101,4141+11]..[101,4141+38])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[101,4141+12]..[101,4141+28])
                      Pexp_ident "dealias_producer" (src/expandTokenAliases.ml[101,4141+12]..[101,4141+28])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[101,4141+29]..[101,4141+37])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[101,4141+29]..[101,4141+37])
                    ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[101,4141+39]..[101,4141+48])
                    Pexp_ident "producers" (src/expandTokenAliases.ml[101,4141+39]..[101,4141+48])
              ]
      <def>
        pattern (src/expandTokenAliases.ml[103,4191+4]..[103,4191+18])
          Ppat_var "dealias_branch" (src/expandTokenAliases.ml[103,4191+4]..[103,4191+18])
        expression (src/expandTokenAliases.ml[103,4191+19]..[104,4253+79]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[103,4191+19]..[103,4191+27])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[103,4191+19]..[103,4191+27])
          expression (src/expandTokenAliases.ml[103,4191+28]..[104,4253+79]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[103,4191+28]..[103,4191+59])
              Ppat_constraint
              pattern (src/expandTokenAliases.ml[103,4191+29]..[103,4191+35])
                Ppat_var "branch" (src/expandTokenAliases.ml[103,4191+29]..[103,4191+35])
              core_type (src/expandTokenAliases.ml[103,4191+38]..[103,4191+58])
                Ptyp_constr "parameterized_branch" (src/expandTokenAliases.ml[103,4191+38]..[103,4191+58])
                []
            expression (src/expandTokenAliases.ml[104,4253+2]..[104,4253+79])
              Pexp_record
              [
                "pr_producers" (src/expandTokenAliases.ml[104,4253+16]..[104,4253+28])
                  expression (src/expandTokenAliases.ml[104,4253+31]..[104,4253+77])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[104,4253+31]..[104,4253+48])
                      Pexp_ident "dealias_producers" (src/expandTokenAliases.ml[104,4253+31]..[104,4253+48])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[104,4253+49]..[104,4253+57])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[104,4253+49]..[104,4253+57])
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[104,4253+58]..[104,4253+77])
                          Pexp_field
                          expression (src/expandTokenAliases.ml[104,4253+58]..[104,4253+64])
                            Pexp_ident "branch" (src/expandTokenAliases.ml[104,4253+58]..[104,4253+64])
                          "pr_producers" (src/expandTokenAliases.ml[104,4253+65]..[104,4253+77])
                    ]
              ]
              Some
                expression (src/expandTokenAliases.ml[104,4253+4]..[104,4253+10])
                  Pexp_ident "branch" (src/expandTokenAliases.ml[104,4253+4]..[104,4253+10])
      <def>
        pattern (src/expandTokenAliases.ml[106,4334+4]..[106,4334+20])
          Ppat_var "dealias_branches" (src/expandTokenAliases.ml[106,4334+4]..[106,4334+20])
        expression (src/expandTokenAliases.ml[106,4334+21]..[107,4375+45]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[106,4334+21]..[106,4334+29])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[106,4334+21]..[106,4334+29])
          expression (src/expandTokenAliases.ml[106,4334+30]..[107,4375+45]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[106,4334+30]..[106,4334+38])
              Ppat_var "branches" (src/expandTokenAliases.ml[106,4334+30]..[106,4334+38])
            expression (src/expandTokenAliases.ml[107,4375+2]..[107,4375+45])
              Pexp_apply
              expression (src/expandTokenAliases.ml[107,4375+2]..[107,4375+10])
                Pexp_ident "List.map" (src/expandTokenAliases.ml[107,4375+2]..[107,4375+10])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[107,4375+11]..[107,4375+36])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[107,4375+12]..[107,4375+26])
                      Pexp_ident "dealias_branch" (src/expandTokenAliases.ml[107,4375+12]..[107,4375+26])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[107,4375+27]..[107,4375+35])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[107,4375+27]..[107,4375+35])
                    ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[107,4375+37]..[107,4375+45])
                    Pexp_ident "branches" (src/expandTokenAliases.ml[107,4375+37]..[107,4375+45])
              ]
    ]
  structure_item (src/expandTokenAliases.ml[109,4422+0]..[110,4455+72])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[109,4422+4]..[109,4422+16])
          Ppat_var "dealias_rule" (src/expandTokenAliases.ml[109,4422+4]..[109,4422+16])
        expression (src/expandTokenAliases.ml[109,4422+17]..[110,4455+72]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[109,4422+17]..[109,4422+25])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[109,4422+17]..[109,4422+25])
          expression (src/expandTokenAliases.ml[109,4422+26]..[110,4455+72]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[109,4422+26]..[109,4422+30])
              Ppat_var "rule" (src/expandTokenAliases.ml[109,4422+26]..[109,4422+30])
            expression (src/expandTokenAliases.ml[110,4455+2]..[110,4455+72])
              Pexp_record
              [
                "pr_branches" (src/expandTokenAliases.ml[110,4455+14]..[110,4455+25])
                  expression (src/expandTokenAliases.ml[110,4455+28]..[110,4455+70])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[110,4455+28]..[110,4455+44])
                      Pexp_ident "dealias_branches" (src/expandTokenAliases.ml[110,4455+28]..[110,4455+44])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[110,4455+45]..[110,4455+53])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[110,4455+45]..[110,4455+53])
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[110,4455+54]..[110,4455+70])
                          Pexp_field
                          expression (src/expandTokenAliases.ml[110,4455+54]..[110,4455+58])
                            Pexp_ident "rule" (src/expandTokenAliases.ml[110,4455+54]..[110,4455+58])
                          "pr_branches" (src/expandTokenAliases.ml[110,4455+59]..[110,4455+70])
                    ]
              ]
              Some
                expression (src/expandTokenAliases.ml[110,4455+4]..[110,4455+8])
                  Pexp_ident "rule" (src/expandTokenAliases.ml[110,4455+4]..[110,4455+8])
    ]
  structure_item (src/expandTokenAliases.ml[112,4529+0]..[129,5183+8])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[112,4529+4]..[112,4529+16])
          Ppat_var "dealias_decl" (src/expandTokenAliases.ml[112,4529+4]..[112,4529+16])
        expression (src/expandTokenAliases.ml[112,4529+17]..[129,5183+8]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[112,4529+17]..[112,4529+25])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[112,4529+17]..[112,4529+25])
          expression (src/expandTokenAliases.ml[112,4529+26]..[129,5183+8]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[112,4529+26]..[112,4529+64])
              Ppat_constraint
              pattern (src/expandTokenAliases.ml[112,4529+27]..[112,4529+31])
                Ppat_var "decl" (src/expandTokenAliases.ml[112,4529+27]..[112,4529+31])
              core_type (src/expandTokenAliases.ml[112,4529+34]..[112,4529+63])
                Ptyp_constr "Positions.located" (src/expandTokenAliases.ml[112,4529+46]..[112,4529+63])
                [
                  core_type (src/expandTokenAliases.ml[112,4529+34]..[112,4529+45])
                    Ptyp_constr "declaration" (src/expandTokenAliases.ml[112,4529+34]..[112,4529+45])
                    []
                ]
            expression (src/expandTokenAliases.ml[113,4596+2]..[129,5183+8])
              Pexp_apply
              expression (src/expandTokenAliases.ml[113,4596+2]..[113,4596+16])
                Pexp_ident "Positions.pmap" (src/expandTokenAliases.ml[113,4596+2]..[113,4596+16])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[113,4596+17]..[129,5183+3])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (src/expandTokenAliases.ml[113,4596+22]..[113,4596+25])
                      Ppat_var "pos" (src/expandTokenAliases.ml[113,4596+22]..[113,4596+25])
                    expression (src/expandTokenAliases.ml[113,4596+26]..[128,5118+64]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (src/expandTokenAliases.ml[113,4596+26]..[113,4596+46])
                        Ppat_constraint
                        pattern (src/expandTokenAliases.ml[113,4596+27]..[113,4596+31])
                          Ppat_var "decl" (src/expandTokenAliases.ml[113,4596+27]..[113,4596+31])
                        core_type (src/expandTokenAliases.ml[113,4596+34]..[113,4596+45])
                          Ptyp_constr "declaration" (src/expandTokenAliases.ml[113,4596+34]..[113,4596+45])
                          []
                      expression (src/expandTokenAliases.ml[114,4646+4]..[128,5118+64])
                        Pexp_match
                        expression (src/expandTokenAliases.ml[114,4646+10]..[114,4646+14])
                          Pexp_ident "decl" (src/expandTokenAliases.ml[114,4646+10]..[114,4646+14])
                        [
                          <case>
                            pattern (src/expandTokenAliases.ml[115,4666+6]..[119,4729+25])
                              Ppat_or
                              pattern (src/expandTokenAliases.ml[115,4666+6]..[118,4714+14])
                                Ppat_or
                                pattern (src/expandTokenAliases.ml[115,4666+6]..[117,4699+14])
                                  Ppat_or
                                  pattern (src/expandTokenAliases.ml[115,4666+6]..[116,4680+18])
                                    Ppat_or
                                    pattern (src/expandTokenAliases.ml[115,4666+6]..[115,4666+13])
                                      Ppat_construct "DCode" (src/expandTokenAliases.ml[115,4666+6]..[115,4666+11])
                                      Some
                                        []
                                        pattern (src/expandTokenAliases.ml[115,4666+12]..[115,4666+13])
                                          Ppat_any
                                    pattern (src/expandTokenAliases.ml[116,4680+6]..[116,4680+18])
                                      Ppat_construct "DParameter" (src/expandTokenAliases.ml[116,4680+6]..[116,4680+16])
                                      Some
                                        []
                                        pattern (src/expandTokenAliases.ml[116,4680+17]..[116,4680+18])
                                          Ppat_any
                                  pattern (src/expandTokenAliases.ml[117,4699+6]..[117,4699+14])
                                    Ppat_construct "DToken" (src/expandTokenAliases.ml[117,4699+6]..[117,4699+12])
                                    Some
                                      []
                                      pattern (src/expandTokenAliases.ml[117,4699+13]..[117,4699+14])
                                        Ppat_any
                                pattern (src/expandTokenAliases.ml[118,4714+6]..[118,4714+14])
                                  Ppat_construct "DStart" (src/expandTokenAliases.ml[118,4714+6]..[118,4714+12])
                                  Some
                                    []
                                    pattern (src/expandTokenAliases.ml[118,4714+13]..[118,4714+14])
                                      Ppat_any
                              pattern (src/expandTokenAliases.ml[119,4729+6]..[119,4729+25])
                                Ppat_construct "DGrammarAttribute" (src/expandTokenAliases.ml[119,4729+6]..[119,4729+23])
                                Some
                                  []
                                  pattern (src/expandTokenAliases.ml[119,4729+24]..[119,4729+25])
                                    Ppat_any
                            expression (src/expandTokenAliases.ml[120,4758+8]..[120,4758+12])
                              Pexp_ident "decl" (src/expandTokenAliases.ml[120,4758+8]..[120,4758+12])
                          <case>
                            pattern (src/expandTokenAliases.ml[121,4771+6]..[121,4771+39])
                              Ppat_construct "DTokenProperties" (src/expandTokenAliases.ml[121,4771+6]..[121,4771+22])
                              Some
                                []
                                pattern (src/expandTokenAliases.ml[121,4771+23]..[121,4771+39])
                                  Ppat_tuple
                                  [
                                    pattern (src/expandTokenAliases.ml[121,4771+24]..[121,4771+25])
                                      Ppat_var "t" (src/expandTokenAliases.ml[121,4771+24]..[121,4771+25])
                                    pattern (src/expandTokenAliases.ml[121,4771+27]..[121,4771+32])
                                      Ppat_var "assoc" (src/expandTokenAliases.ml[121,4771+27]..[121,4771+32])
                                    pattern (src/expandTokenAliases.ml[121,4771+34]..[121,4771+38])
                                      Ppat_var "prec" (src/expandTokenAliases.ml[121,4771+34]..[121,4771+38])
                                  ]
                            expression (src/expandTokenAliases.ml[122,4814+8]..[122,4814+71])
                              Pexp_construct "DTokenProperties" (src/expandTokenAliases.ml[122,4814+8]..[122,4814+24])
                              Some
                                expression (src/expandTokenAliases.ml[122,4814+25]..[122,4814+71])
                                  Pexp_tuple
                                  [
                                    expression (src/expandTokenAliases.ml[122,4814+26]..[122,4814+57])
                                      Pexp_apply
                                      expression (src/expandTokenAliases.ml[122,4814+26]..[122,4814+42])
                                        Pexp_ident "dealias_terminal" (src/expandTokenAliases.ml[122,4814+26]..[122,4814+42])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[122,4814+43]..[122,4814+51])
                                            Pexp_ident "aliasmap" (src/expandTokenAliases.ml[122,4814+43]..[122,4814+51])
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[122,4814+52]..[122,4814+55])
                                            Pexp_ident "pos" (src/expandTokenAliases.ml[122,4814+52]..[122,4814+55])
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[122,4814+56]..[122,4814+57])
                                            Pexp_ident "t" (src/expandTokenAliases.ml[122,4814+56]..[122,4814+57])
                                      ]
                                    expression (src/expandTokenAliases.ml[122,4814+59]..[122,4814+64])
                                      Pexp_ident "assoc" (src/expandTokenAliases.ml[122,4814+59]..[122,4814+64])
                                    expression (src/expandTokenAliases.ml[122,4814+66]..[122,4814+70])
                                      Pexp_ident "prec" (src/expandTokenAliases.ml[122,4814+66]..[122,4814+70])
                                  ]
                          <case>
                            pattern (src/expandTokenAliases.ml[123,4886+6]..[123,4886+23])
                              Ppat_construct "DType" (src/expandTokenAliases.ml[123,4886+6]..[123,4886+11])
                              Some
                                []
                                pattern (src/expandTokenAliases.ml[123,4886+12]..[123,4886+23])
                                  Ppat_tuple
                                  [
                                    pattern (src/expandTokenAliases.ml[123,4886+13]..[123,4886+15])
                                      Ppat_var "ty" (src/expandTokenAliases.ml[123,4886+13]..[123,4886+15])
                                    pattern (src/expandTokenAliases.ml[123,4886+17]..[123,4886+22])
                                      Ppat_var "param" (src/expandTokenAliases.ml[123,4886+17]..[123,4886+22])
                                  ]
                            expression (src/expandTokenAliases.ml[124,4913+8]..[124,4913+52])
                              Pexp_construct "DType" (src/expandTokenAliases.ml[124,4913+8]..[124,4913+13])
                              Some
                                expression (src/expandTokenAliases.ml[124,4913+14]..[124,4913+52])
                                  Pexp_tuple
                                  [
                                    expression (src/expandTokenAliases.ml[124,4913+15]..[124,4913+17])
                                      Pexp_ident "ty" (src/expandTokenAliases.ml[124,4913+15]..[124,4913+17])
                                    expression (src/expandTokenAliases.ml[124,4913+19]..[124,4913+51])
                                      Pexp_apply
                                      expression (src/expandTokenAliases.ml[124,4913+19]..[124,4913+36])
                                        Pexp_ident "dealias_parameter" (src/expandTokenAliases.ml[124,4913+19]..[124,4913+36])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[124,4913+37]..[124,4913+45])
                                            Pexp_ident "aliasmap" (src/expandTokenAliases.ml[124,4913+37]..[124,4913+45])
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[124,4913+46]..[124,4913+51])
                                            Pexp_ident "param" (src/expandTokenAliases.ml[124,4913+46]..[124,4913+51])
                                      ]
                                  ]
                          <case>
                            pattern (src/expandTokenAliases.ml[125,4966+6]..[125,4966+39])
                              Ppat_construct "DSymbolAttributes" (src/expandTokenAliases.ml[125,4966+6]..[125,4966+23])
                              Some
                                []
                                pattern (src/expandTokenAliases.ml[125,4966+24]..[125,4966+39])
                                  Ppat_tuple
                                  [
                                    pattern (src/expandTokenAliases.ml[125,4966+25]..[125,4966+31])
                                      Ppat_var "params" (src/expandTokenAliases.ml[125,4966+25]..[125,4966+31])
                                    pattern (src/expandTokenAliases.ml[125,4966+33]..[125,4966+38])
                                      Ppat_var "attrs" (src/expandTokenAliases.ml[125,4966+33]..[125,4966+38])
                                  ]
                            expression (src/expandTokenAliases.ml[126,5009+8]..[126,5009+69])
                              Pexp_construct "DSymbolAttributes" (src/expandTokenAliases.ml[126,5009+8]..[126,5009+25])
                              Some
                                expression (src/expandTokenAliases.ml[126,5009+26]..[126,5009+69])
                                  Pexp_tuple
                                  [
                                    expression (src/expandTokenAliases.ml[126,5009+27]..[126,5009+61])
                                      Pexp_apply
                                      expression (src/expandTokenAliases.ml[126,5009+27]..[126,5009+45])
                                        Pexp_ident "dealias_parameters" (src/expandTokenAliases.ml[126,5009+27]..[126,5009+45])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[126,5009+46]..[126,5009+54])
                                            Pexp_ident "aliasmap" (src/expandTokenAliases.ml[126,5009+46]..[126,5009+54])
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[126,5009+55]..[126,5009+61])
                                            Pexp_ident "params" (src/expandTokenAliases.ml[126,5009+55]..[126,5009+61])
                                      ]
                                    expression (src/expandTokenAliases.ml[126,5009+63]..[126,5009+68])
                                      Pexp_ident "attrs" (src/expandTokenAliases.ml[126,5009+63]..[126,5009+68])
                                  ]
                          <case>
                            pattern (src/expandTokenAliases.ml[127,5079+6]..[127,5079+35])
                              Ppat_construct "DOnErrorReduce" (src/expandTokenAliases.ml[127,5079+6]..[127,5079+20])
                              Some
                                []
                                pattern (src/expandTokenAliases.ml[127,5079+21]..[127,5079+35])
                                  Ppat_tuple
                                  [
                                    pattern (src/expandTokenAliases.ml[127,5079+22]..[127,5079+27])
                                      Ppat_var "param" (src/expandTokenAliases.ml[127,5079+22]..[127,5079+27])
                                    pattern (src/expandTokenAliases.ml[127,5079+29]..[127,5079+34])
                                      Ppat_var "level" (src/expandTokenAliases.ml[127,5079+29]..[127,5079+34])
                                  ]
                            expression (src/expandTokenAliases.ml[128,5118+8]..[128,5118+64])
                              Pexp_construct "DOnErrorReduce" (src/expandTokenAliases.ml[128,5118+8]..[128,5118+22])
                              Some
                                expression (src/expandTokenAliases.ml[128,5118+23]..[128,5118+64])
                                  Pexp_tuple
                                  [
                                    expression (src/expandTokenAliases.ml[128,5118+24]..[128,5118+56])
                                      Pexp_apply
                                      expression (src/expandTokenAliases.ml[128,5118+24]..[128,5118+41])
                                        Pexp_ident "dealias_parameter" (src/expandTokenAliases.ml[128,5118+24]..[128,5118+41])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[128,5118+42]..[128,5118+50])
                                            Pexp_ident "aliasmap" (src/expandTokenAliases.ml[128,5118+42]..[128,5118+50])
                                        <arg>
                                        Nolabel
                                          expression (src/expandTokenAliases.ml[128,5118+51]..[128,5118+56])
                                            Pexp_ident "param" (src/expandTokenAliases.ml[128,5118+51]..[128,5118+56])
                                      ]
                                    expression (src/expandTokenAliases.ml[128,5118+58]..[128,5118+63])
                                      Pexp_ident "level" (src/expandTokenAliases.ml[128,5118+58]..[128,5118+63])
                                  ]
                        ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[129,5183+4]..[129,5183+8])
                    Pexp_ident "decl" (src/expandTokenAliases.ml[129,5183+4]..[129,5183+8])
              ]
    ]
  structure_item (src/expandTokenAliases.ml[131,5193+0]..[134,5311+60])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[131,5193+4]..[131,5193+19])
          Ppat_var "dealias_grammar" (src/expandTokenAliases.ml[131,5193+4]..[131,5193+19])
        expression (src/expandTokenAliases.ml[131,5193+20]..[134,5311+60]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[131,5193+20]..[131,5193+28])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[131,5193+20]..[131,5193+28])
          expression (src/expandTokenAliases.ml[131,5193+29]..[134,5311+60]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[131,5193+29]..[131,5193+30])
              Ppat_var "g" (src/expandTokenAliases.ml[131,5193+29]..[131,5193+30])
            expression (src/expandTokenAliases.ml[132,5226+2]..[134,5311+60])
              Pexp_record
              [
                "pg_declarations" (src/expandTokenAliases.ml[133,5237+4]..[133,5237+19])
                  expression (src/expandTokenAliases.ml[133,5237+22]..[133,5237+72])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[133,5237+22]..[133,5237+30])
                      Pexp_ident "List.map" (src/expandTokenAliases.ml[133,5237+22]..[133,5237+30])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[133,5237+31]..[133,5237+54])
                          Pexp_apply
                          expression (src/expandTokenAliases.ml[133,5237+32]..[133,5237+44])
                            Pexp_ident "dealias_decl" (src/expandTokenAliases.ml[133,5237+32]..[133,5237+44])
                          [
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[133,5237+45]..[133,5237+53])
                                Pexp_ident "aliasmap" (src/expandTokenAliases.ml[133,5237+45]..[133,5237+53])
                          ]
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[133,5237+55]..[133,5237+72])
                          Pexp_field
                          expression (src/expandTokenAliases.ml[133,5237+55]..[133,5237+56])
                            Pexp_ident "g" (src/expandTokenAliases.ml[133,5237+55]..[133,5237+56])
                          "pg_declarations" (src/expandTokenAliases.ml[133,5237+57]..[133,5237+72])
                    ]
                "pg_rules" (src/expandTokenAliases.ml[134,5311+4]..[134,5311+12])
                  expression (src/expandTokenAliases.ml[134,5311+15]..[134,5311+58])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[134,5311+15]..[134,5311+23])
                      Pexp_ident "List.map" (src/expandTokenAliases.ml[134,5311+15]..[134,5311+23])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[134,5311+24]..[134,5311+47])
                          Pexp_apply
                          expression (src/expandTokenAliases.ml[134,5311+25]..[134,5311+37])
                            Pexp_ident "dealias_rule" (src/expandTokenAliases.ml[134,5311+25]..[134,5311+37])
                          [
                            <arg>
                            Nolabel
                              expression (src/expandTokenAliases.ml[134,5311+38]..[134,5311+46])
                                Pexp_ident "aliasmap" (src/expandTokenAliases.ml[134,5311+38]..[134,5311+46])
                          ]
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[134,5311+48]..[134,5311+58])
                          Pexp_field
                          expression (src/expandTokenAliases.ml[134,5311+48]..[134,5311+49])
                            Pexp_ident "g" (src/expandTokenAliases.ml[134,5311+48]..[134,5311+49])
                          "pg_rules" (src/expandTokenAliases.ml[134,5311+50]..[134,5311+58])
                    ]
              ]
              Some
                expression (src/expandTokenAliases.ml[132,5226+4]..[132,5226+5])
                  Pexp_ident "g" (src/expandTokenAliases.ml[132,5226+4]..[132,5226+5])
    ]
  structure_item (src/expandTokenAliases.ml[136,5373+0]..[137,5408+40])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[136,5373+4]..[136,5373+20])
          Ppat_var "dealias_grammars" (src/expandTokenAliases.ml[136,5373+4]..[136,5373+20])
        expression (src/expandTokenAliases.ml[136,5373+21]..[137,5408+40]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[136,5373+21]..[136,5373+29])
            Ppat_var "aliasmap" (src/expandTokenAliases.ml[136,5373+21]..[136,5373+29])
          expression (src/expandTokenAliases.ml[136,5373+30]..[137,5408+40]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (src/expandTokenAliases.ml[136,5373+30]..[136,5373+32])
              Ppat_var "gs" (src/expandTokenAliases.ml[136,5373+30]..[136,5373+32])
            expression (src/expandTokenAliases.ml[137,5408+2]..[137,5408+40])
              Pexp_apply
              expression (src/expandTokenAliases.ml[137,5408+2]..[137,5408+10])
                Pexp_ident "List.map" (src/expandTokenAliases.ml[137,5408+2]..[137,5408+10])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[137,5408+11]..[137,5408+37])
                    Pexp_apply
                    expression (src/expandTokenAliases.ml[137,5408+12]..[137,5408+27])
                      Pexp_ident "dealias_grammar" (src/expandTokenAliases.ml[137,5408+12]..[137,5408+27])
                    [
                      <arg>
                      Nolabel
                        expression (src/expandTokenAliases.ml[137,5408+28]..[137,5408+36])
                          Pexp_ident "aliasmap" (src/expandTokenAliases.ml[137,5408+28]..[137,5408+36])
                    ]
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[137,5408+38]..[137,5408+40])
                    Pexp_ident "gs" (src/expandTokenAliases.ml[137,5408+38]..[137,5408+40])
              ]
    ]
  structure_item (src/expandTokenAliases.ml[143,5585+0]..[145,5664+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[143,5585+4]..[143,5585+20])
          Ppat_var "dealias_grammars" (src/expandTokenAliases.ml[143,5585+4]..[143,5585+20])
        expression (src/expandTokenAliases.ml[143,5585+21]..[145,5664+30]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (src/expandTokenAliases.ml[143,5585+21]..[143,5585+23])
            Ppat_var "gs" (src/expandTokenAliases.ml[143,5585+21]..[143,5585+23])
          expression (src/expandTokenAliases.ml[144,5611+2]..[145,5664+30])
            Pexp_let Nonrec
            [
              <def>
                pattern (src/expandTokenAliases.ml[144,5611+6]..[144,5611+14])
                  Ppat_var "aliasmap" (src/expandTokenAliases.ml[144,5611+6]..[144,5611+14])
                expression (src/expandTokenAliases.ml[144,5611+17]..[144,5611+49])
                  Pexp_apply
                  expression (src/expandTokenAliases.ml[144,5611+17]..[144,5611+46])
                    Pexp_ident "collect_aliases_from_grammars" (src/expandTokenAliases.ml[144,5611+17]..[144,5611+46])
                  [
                    <arg>
                    Nolabel
                      expression (src/expandTokenAliases.ml[144,5611+47]..[144,5611+49])
                        Pexp_ident "gs" (src/expandTokenAliases.ml[144,5611+47]..[144,5611+49])
                  ]
            ]
            expression (src/expandTokenAliases.ml[145,5664+2]..[145,5664+30])
              Pexp_apply
              expression (src/expandTokenAliases.ml[145,5664+2]..[145,5664+18])
                Pexp_ident "dealias_grammars" (src/expandTokenAliases.ml[145,5664+2]..[145,5664+18])
              [
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[145,5664+19]..[145,5664+27])
                    Pexp_ident "aliasmap" (src/expandTokenAliases.ml[145,5664+19]..[145,5664+27])
                <arg>
                Nolabel
                  expression (src/expandTokenAliases.ml[145,5664+28]..[145,5664+30])
                    Pexp_ident "gs" (src/expandTokenAliases.ml[145,5664+28]..[145,5664+30])
              ]
    ]
]

open Syntax
type aliasmap = (terminal * Positions.t) StringMap.t
let collect_aliases_from_declaration (aliasmap : aliasmap) decl =
  (match Positions.value decl with
   | DToken (_, id, Some qid, _) ->
       (match StringMap.find qid aliasmap with
        | exception Not_found ->
            StringMap.add qid (id, (Positions.position decl)) aliasmap
        | (id0, pos) ->
            Error.error [Positions.position decl; pos]
              "%s cannot be declared as an alias for the symbol %s.\nIt has already been declared as an alias for %s."
              qid id id0)
   | _ -> aliasmap : aliasmap)
let collect_aliases_from_grammar aliasmap g =
  List.fold_left collect_aliases_from_declaration aliasmap g.pg_declarations
let collect_aliases_from_grammars gs =
  (List.fold_left collect_aliases_from_grammar StringMap.empty gs : aliasmap)
let dealias_terminal (aliasmap : aliasmap) pos (t : terminal) =
  (if (t.[0]) = '"'
   then
     match StringMap.find t aliasmap with
     | (id, _) -> id
     | exception Not_found ->
         Error.error [pos] "the token alias %s was never declared." t
   else t : terminal)
let dealias_symbol aliasmap (sym : terminal Positions.located) =
  Positions.pmap (dealias_terminal aliasmap) sym
let rec dealias_parameter aliasmap (param : parameter) =
  match param with
  | ParameterVar sym -> ParameterVar (dealias_symbol aliasmap sym)
  | ParameterApp (sym, params) ->
      ParameterApp
        ((dealias_symbol aliasmap sym), (dealias_parameters aliasmap params))
  | ParameterAnonymous branches ->
      ParameterAnonymous (Positions.map (dealias_branches aliasmap) branches)
and dealias_parameters aliasmap params =
  List.map (dealias_parameter aliasmap) params
and dealias_producer aliasmap (producer : producer) =
  let (id, param, attrs) = producer in
  (id, (dealias_parameter aliasmap param), attrs)
and dealias_producers aliasmap producers =
  List.map (dealias_producer aliasmap) producers
and dealias_branch aliasmap (branch : parameterized_branch) =
  {
    branch with
    pr_producers = (dealias_producers aliasmap branch.pr_producers)
  }
and dealias_branches aliasmap branches =
  List.map (dealias_branch aliasmap) branches
let dealias_rule aliasmap rule =
  { rule with pr_branches = (dealias_branches aliasmap rule.pr_branches) }
let dealias_decl aliasmap (decl : declaration Positions.located) =
  Positions.pmap
    (fun pos ->
       fun (decl : declaration) ->
         match decl with
         | DCode _ | DParameter _ | DToken _ | DStart _ | DGrammarAttribute _
             -> decl
         | DTokenProperties (t, assoc, prec) ->
             DTokenProperties
               ((dealias_terminal aliasmap pos t), assoc, prec)
         | DType (ty, param) ->
             DType (ty, (dealias_parameter aliasmap param))
         | DSymbolAttributes (params, attrs) ->
             DSymbolAttributes ((dealias_parameters aliasmap params), attrs)
         | DOnErrorReduce (param, level) ->
             DOnErrorReduce ((dealias_parameter aliasmap param), level)) decl
let dealias_grammar aliasmap g =
  {
    g with
    pg_declarations = (List.map (dealias_decl aliasmap) g.pg_declarations);
    pg_rules = (List.map (dealias_rule aliasmap) g.pg_rules)
  }
let dealias_grammars aliasmap gs = List.map (dealias_grammar aliasmap) gs
let dealias_grammars gs =
  let aliasmap = collect_aliases_from_grammars gs in
  dealias_grammars aliasmap gs
[
  structure_item (src/expandTokenAliases.ml[14,1008+0]..src/expandTokenAliases.ml[14,1008+11])
    Tstr_open Fresh
    module_expr (src/expandTokenAliases.ml[14,1008+5]..src/expandTokenAliases.ml[14,1008+11])
      Tmod_ident "Dune__exe!.Syntax"
  structure_item (src/expandTokenAliases.ml[22,1344+0]..src/expandTokenAliases.ml[23,1360+38])
    Tstr_type Rec
    [
      type_declaration aliasmap/431 (src/expandTokenAliases.ml[22,1344+0]..src/expandTokenAliases.ml[23,1360+38])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ttype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (src/expandTokenAliases.ml[23,1360+2]..src/expandTokenAliases.ml[23,1360+38])
              Ttyp_constr "Dune__exe!.StringMap.t"
              [
                core_type (src/expandTokenAliases.ml[23,1360+3]..src/expandTokenAliases.ml[23,1360+25])
                  Ttyp_tuple
                  [
                    core_type (src/expandTokenAliases.ml[23,1360+3]..src/expandTokenAliases.ml[23,1360+11])
                      Ttyp_constr "Dune__exe!.Syntax.terminal"
                      []
                    core_type (src/expandTokenAliases.ml[23,1360+14]..src/expandTokenAliases.ml[23,1360+25])
                      Ttyp_constr "Dune__exe!.Positions.t"
                      []
                  ]
              ]
    ]
  structure_item (src/expandTokenAliases.ml[29,1558+0]..src/expandTokenAliases.ml[46,2277+14])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[29,1558+4]..src/expandTokenAliases.ml[29,1558+36])
          Tpat_var "collect_aliases_from_declaration/598"
        expression (src/expandTokenAliases.ml[29,1558+37]..src/expandTokenAliases.ml[46,2277+14]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[29,1558+38]..src/expandTokenAliases.ml[29,1558+46])
                extra
                  Tpat_extra_constraint
                  core_type (src/expandTokenAliases.ml[29,1558+49]..src/expandTokenAliases.ml[29,1558+57])
                    Ttyp_constr "aliasmap/431"
                    []
                Tpat_alias "aliasmap/600"
                pattern (src/expandTokenAliases.ml[29,1558+38]..src/expandTokenAliases.ml[29,1558+46])
                  Tpat_any
              expression (src/expandTokenAliases.ml[29,1558+59]..src/expandTokenAliases.ml[46,2277+14]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[29,1558+59]..src/expandTokenAliases.ml[29,1558+63])
                      Tpat_var "decl/601"
                    expression (src/expandTokenAliases.ml[30,1635+2]..src/expandTokenAliases.ml[46,2277+14])
                      extra
                        Texp_constraint
                        core_type (src/expandTokenAliases.ml[29,1558+66]..src/expandTokenAliases.ml[29,1558+74])
                          Ttyp_constr "aliasmap/431"
                          []
                      Texp_match
                      expression (src/expandTokenAliases.ml[30,1635+8]..src/expandTokenAliases.ml[30,1635+28])
                        Texp_apply
                        expression (src/expandTokenAliases.ml[30,1635+8]..src/expandTokenAliases.ml[30,1635+23])
                          Texp_ident "Dune__exe!.Positions.value"
                        [
                          <arg>
                            Nolabel
                            expression (src/expandTokenAliases.ml[30,1635+24]..src/expandTokenAliases.ml[30,1635+28])
                              Texp_ident "decl/601"
                        ]
                      [
                        <case>
                          pattern (src/expandTokenAliases.ml[31,1669+4]..src/expandTokenAliases.ml[31,1669+31])
                            Tpat_value
                            pattern (src/expandTokenAliases.ml[31,1669+4]..src/expandTokenAliases.ml[31,1669+31])
                              Tpat_construct "DToken"
                              [
                                pattern (src/expandTokenAliases.ml[31,1669+12]..src/expandTokenAliases.ml[31,1669+13])
                                  Tpat_any
                                pattern (src/expandTokenAliases.ml[31,1669+15]..src/expandTokenAliases.ml[31,1669+17])
                                  Tpat_var "id/602"
                                pattern (src/expandTokenAliases.ml[31,1669+19]..src/expandTokenAliases.ml[31,1669+27])
                                  Tpat_construct "Some"
                                  [
                                    pattern (src/expandTokenAliases.ml[31,1669+24]..src/expandTokenAliases.ml[31,1669+27])
                                      Tpat_var "qid/603"
                                  ]
                                  None
                                pattern (src/expandTokenAliases.ml[31,1669+29]..src/expandTokenAliases.ml[31,1669+30])
                                  Tpat_any
                              ]
                              None
                          expression (src/expandTokenAliases.ml[32,1704+6]..src/expandTokenAliases.ml[44,2258+9])
                            Texp_match
                            expression (src/expandTokenAliases.ml[32,1704+18]..src/expandTokenAliases.ml[32,1704+45])
                              Texp_apply
                              expression (src/expandTokenAliases.ml[32,1704+18]..src/expandTokenAliases.ml[32,1704+32])
                                Texp_ident "Dune__exe!.StringMap.find"
                              [
                                <arg>
                                  Nolabel
                                  expression (src/expandTokenAliases.ml[32,1704+33]..src/expandTokenAliases.ml[32,1704+36])
                                    Texp_ident "qid/603"
                                <arg>
                                  Nolabel
                                  expression (src/expandTokenAliases.ml[32,1704+37]..src/expandTokenAliases.ml[32,1704+45])
                                    Texp_ident "aliasmap/600"
                              ]
                            [
                              <case>
                                pattern (src/expandTokenAliases.ml[33,1755+8]..src/expandTokenAliases.ml[33,1755+27])
                                  Tpat_exception
                                  pattern (src/expandTokenAliases.ml[33,1755+18]..src/expandTokenAliases.ml[33,1755+27])
                                    Tpat_construct "Not_found"
                                    []
                                    None
                                expression (src/expandTokenAliases.ml[35,1850+10]..src/expandTokenAliases.ml[35,1850+66])
                                  Texp_apply
                                  expression (src/expandTokenAliases.ml[35,1850+10]..src/expandTokenAliases.ml[35,1850+23])
                                    Texp_ident "Dune__exe!.StringMap.add"
                                  [
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[35,1850+24]..src/expandTokenAliases.ml[35,1850+27])
                                        Texp_ident "qid/603"
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[35,1850+28]..src/expandTokenAliases.ml[35,1850+57])
                                        Texp_tuple
                                        [
                                          expression (src/expandTokenAliases.ml[35,1850+29]..src/expandTokenAliases.ml[35,1850+31])
                                            Texp_ident "id/602"
                                          expression (src/expandTokenAliases.ml[35,1850+33]..src/expandTokenAliases.ml[35,1850+56])
                                            Texp_apply
                                            expression (src/expandTokenAliases.ml[35,1850+33]..src/expandTokenAliases.ml[35,1850+51])
                                              Texp_ident "Dune__exe!.Positions.position"
                                            [
                                              <arg>
                                                Nolabel
                                                expression (src/expandTokenAliases.ml[35,1850+52]..src/expandTokenAliases.ml[35,1850+56])
                                                  Texp_ident "decl/601"
                                            ]
                                        ]
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[35,1850+58]..src/expandTokenAliases.ml[35,1850+66])
                                        Texp_ident "aliasmap/600"
                                  ]
                              <case>
                                pattern (src/expandTokenAliases.ml[36,1917+8]..src/expandTokenAliases.ml[36,1917+16])
                                  Tpat_value
                                  pattern (src/expandTokenAliases.ml[36,1917+8]..src/expandTokenAliases.ml[36,1917+16])
                                    Tpat_tuple
                                    [
                                      pattern (src/expandTokenAliases.ml[36,1917+8]..src/expandTokenAliases.ml[36,1917+11])
                                        Tpat_var "id0/604"
                                      pattern (src/expandTokenAliases.ml[36,1917+13]..src/expandTokenAliases.ml[36,1917+16])
                                        Tpat_var "pos/605"
                                    ]
                                expression (src/expandTokenAliases.ml[39,2038+10]..src/expandTokenAliases.ml[43,2235+22])
                                  Texp_apply
                                  expression (src/expandTokenAliases.ml[39,2038+10]..src/expandTokenAliases.ml[39,2038+21])
                                    Texp_ident "Dune__exe!.Error.error"
                                  [
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[40,2060+12]..src/expandTokenAliases.ml[40,2060+42])
                                        Texp_construct "::"
                                        [
                                          expression (src/expandTokenAliases.ml[40,2060+13]..src/expandTokenAliases.ml[40,2060+36])
                                            Texp_apply
                                            expression (src/expandTokenAliases.ml[40,2060+13]..src/expandTokenAliases.ml[40,2060+31])
                                              Texp_ident "Dune__exe!.Positions.position"
                                            [
                                              <arg>
                                                Nolabel
                                                expression (src/expandTokenAliases.ml[40,2060+32]..src/expandTokenAliases.ml[40,2060+36])
                                                  Texp_ident "decl/601"
                                            ]
                                          expression (src/expandTokenAliases.ml[40,2060+38]..src/expandTokenAliases.ml[40,2060+42]) ghost
                                            Texp_construct "::"
                                            [
                                              expression (src/expandTokenAliases.ml[40,2060+38]..src/expandTokenAliases.ml[40,2060+41])
                                                Texp_ident "pos/605"
                                              expression (src/expandTokenAliases.ml[40,2060+41]..src/expandTokenAliases.ml[40,2060+42]) ghost
                                                Texp_construct "[]"
                                                []
                                            ]
                                        ]
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62])
                                        Texp_construct "CamlinternalFormatBasics.Format"
                                        [
                                          expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                            Texp_construct "CamlinternalFormatBasics.String"
                                            [
                                              expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                Texp_construct "CamlinternalFormatBasics.No_padding"
                                                []
                                              expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                Texp_construct "CamlinternalFormatBasics.String_literal"
                                                [
                                                  expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                    Texp_constant Const_string(" cannot be declared as an alias for the symbol ",(src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost,None)
                                                  expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                    Texp_construct "CamlinternalFormatBasics.String"
                                                    [
                                                      expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                        Texp_construct "CamlinternalFormatBasics.No_padding"
                                                        []
                                                      expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                        Texp_construct "CamlinternalFormatBasics.String_literal"
                                                        [
                                                          expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                            Texp_constant Const_string(".\nIt has already been declared as an alias for ",(src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost,None)
                                                          expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                            Texp_construct "CamlinternalFormatBasics.String"
                                                            [
                                                              expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                                Texp_construct "CamlinternalFormatBasics.No_padding"
                                                                []
                                                              expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                                Texp_construct "CamlinternalFormatBasics.Char_literal"
                                                                [
                                                                  expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                                    Texp_constant Const_char 2e
                                                                  expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                                                    Texp_construct "CamlinternalFormatBasics.End_of_format"
                                                                    []
                                                                ]
                                                            ]
                                                        ]
                                                    ]
                                                ]
                                            ]
                                          expression (src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost
                                            Texp_constant Const_string("%s cannot be declared as an alias for the symbol %s.\nIt has already been declared as an alias for %s.",(src/expandTokenAliases.ml[41,2103+12]..src/expandTokenAliases.ml[42,2172+62]) ghost,None)
                                        ]
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[43,2235+12]..src/expandTokenAliases.ml[43,2235+15])
                                        Texp_ident "qid/603"
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[43,2235+16]..src/expandTokenAliases.ml[43,2235+18])
                                        Texp_ident "id/602"
                                    <arg>
                                      Nolabel
                                      expression (src/expandTokenAliases.ml[43,2235+19]..src/expandTokenAliases.ml[43,2235+22])
                                        Texp_ident "id0/604"
                                  ]
                            ]
                        <case>
                          pattern (src/expandTokenAliases.ml[45,2268+4]..src/expandTokenAliases.ml[45,2268+5])
                            Tpat_value
                            pattern (src/expandTokenAliases.ml[45,2268+4]..src/expandTokenAliases.ml[45,2268+5])
                              Tpat_any
                          expression (src/expandTokenAliases.ml[46,2277+6]..src/expandTokenAliases.ml[46,2277+14])
                            Texp_ident "aliasmap/600"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[50,2373+0]..src/expandTokenAliases.ml[51,2419+76])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[50,2373+4]..src/expandTokenAliases.ml[50,2373+32])
          Tpat_var "collect_aliases_from_grammar/646"
        expression (src/expandTokenAliases.ml[50,2373+33]..src/expandTokenAliases.ml[51,2419+76]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[50,2373+33]..src/expandTokenAliases.ml[50,2373+41])
                Tpat_var "aliasmap/648"
              expression (src/expandTokenAliases.ml[50,2373+42]..src/expandTokenAliases.ml[51,2419+76]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[50,2373+42]..src/expandTokenAliases.ml[50,2373+43])
                      Tpat_var "g/649"
                    expression (src/expandTokenAliases.ml[51,2419+2]..src/expandTokenAliases.ml[51,2419+76])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[51,2419+2]..src/expandTokenAliases.ml[51,2419+16])
                        Texp_ident "Stdlib!.List.fold_left"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[51,2419+17]..src/expandTokenAliases.ml[51,2419+49])
                            Texp_ident "collect_aliases_from_declaration/598"
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[51,2419+50]..src/expandTokenAliases.ml[51,2419+58])
                            Texp_ident "aliasmap/648"
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[51,2419+59]..src/expandTokenAliases.ml[51,2419+76])
                            Texp_field
                            expression (src/expandTokenAliases.ml[51,2419+59]..src/expandTokenAliases.ml[51,2419+60])
                              Texp_ident "g/649"
                            "pg_declarations"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[53,2497+0]..src/expandTokenAliases.ml[54,2547+64])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[53,2497+4]..src/expandTokenAliases.ml[53,2497+33])
          Tpat_var "collect_aliases_from_grammars/716"
        expression (src/expandTokenAliases.ml[53,2497+34]..src/expandTokenAliases.ml[54,2547+64]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[53,2497+34]..src/expandTokenAliases.ml[53,2497+36])
                Tpat_var "gs/718"
              expression (src/expandTokenAliases.ml[54,2547+2]..src/expandTokenAliases.ml[54,2547+64])
                extra
                  Texp_constraint
                  core_type (src/expandTokenAliases.ml[53,2497+39]..src/expandTokenAliases.ml[53,2497+47])
                    Ttyp_constr "aliasmap/431"
                    []
                Texp_apply
                expression (src/expandTokenAliases.ml[54,2547+2]..src/expandTokenAliases.ml[54,2547+16])
                  Texp_ident "Stdlib!.List.fold_left"
                [
                  <arg>
                    Nolabel
                    expression (src/expandTokenAliases.ml[54,2547+17]..src/expandTokenAliases.ml[54,2547+45])
                      Texp_ident "collect_aliases_from_grammar/646"
                  <arg>
                    Nolabel
                    expression (src/expandTokenAliases.ml[54,2547+46]..src/expandTokenAliases.ml[54,2547+61])
                      Texp_ident "Dune__exe!.StringMap.empty"
                  <arg>
                    Nolabel
                    expression (src/expandTokenAliases.ml[54,2547+62]..src/expandTokenAliases.ml[54,2547+64])
                      Texp_ident "gs/718"
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[61,2829+0]..src/expandTokenAliases.ml[73,3244+5])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[61,2829+4]..src/expandTokenAliases.ml[61,2829+20])
          Tpat_var "dealias_terminal/719"
        expression (src/expandTokenAliases.ml[61,2829+21]..src/expandTokenAliases.ml[73,3244+5]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[61,2829+22]..src/expandTokenAliases.ml[61,2829+30])
                extra
                  Tpat_extra_constraint
                  core_type (src/expandTokenAliases.ml[61,2829+33]..src/expandTokenAliases.ml[61,2829+41])
                    Ttyp_constr "aliasmap/431"
                    []
                Tpat_alias "aliasmap/721"
                pattern (src/expandTokenAliases.ml[61,2829+22]..src/expandTokenAliases.ml[61,2829+30])
                  Tpat_any
              expression (src/expandTokenAliases.ml[61,2829+43]..src/expandTokenAliases.ml[73,3244+5]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[61,2829+43]..src/expandTokenAliases.ml[61,2829+46])
                      Tpat_var "pos/722"
                    expression (src/expandTokenAliases.ml[61,2829+47]..src/expandTokenAliases.ml[73,3244+5]) ghost
                      Texp_function
                      Nolabel
                      [
                        <case>
                          pattern (src/expandTokenAliases.ml[61,2829+48]..src/expandTokenAliases.ml[61,2829+49])
                            extra
                              Tpat_extra_constraint
                              core_type (src/expandTokenAliases.ml[61,2829+52]..src/expandTokenAliases.ml[61,2829+60])
                                Ttyp_constr "Dune__exe!.Syntax.terminal"
                                []
                            Tpat_alias "t/723"
                            pattern (src/expandTokenAliases.ml[61,2829+48]..src/expandTokenAliases.ml[61,2829+49])
                              Tpat_any
                          expression (src/expandTokenAliases.ml[64,3030+2]..src/expandTokenAliases.ml[73,3244+5])
                            extra
                              Texp_constraint
                              core_type (src/expandTokenAliases.ml[61,2829+64]..src/expandTokenAliases.ml[61,2829+72])
                                Ttyp_constr "Dune__exe!.Syntax.terminal"
                                []
                            Texp_ifthenelse
                            expression (src/expandTokenAliases.ml[64,3030+5]..src/expandTokenAliases.ml[64,3030+16])
                              Texp_apply
                              expression (src/expandTokenAliases.ml[64,3030+11]..src/expandTokenAliases.ml[64,3030+12])
                                Texp_ident "Stdlib!.="
                              [
                                <arg>
                                  Nolabel
                                  expression (src/expandTokenAliases.ml[64,3030+5]..src/expandTokenAliases.ml[64,3030+10])
                                    Texp_apply
                                    expression (src/expandTokenAliases.ml[64,3030+5]..src/expandTokenAliases.ml[64,3030+10]) ghost
                                      Texp_ident "Stdlib!.String.get"
                                    [
                                      <arg>
                                        Nolabel
                                        expression (src/expandTokenAliases.ml[64,3030+5]..src/expandTokenAliases.ml[64,3030+6])
                                          Texp_ident "t/723"
                                      <arg>
                                        Nolabel
                                        expression (src/expandTokenAliases.ml[64,3030+8]..src/expandTokenAliases.ml[64,3030+9])
                                          Texp_constant Const_int 0
                                    ]
                                <arg>
                                  Nolabel
                                  expression (src/expandTokenAliases.ml[64,3030+13]..src/expandTokenAliases.ml[64,3030+16])
                                    Texp_constant Const_char 22
                              ]
                            expression (src/expandTokenAliases.ml[65,3052+4]..src/expandTokenAliases.ml[71,3184+52])
                              Texp_match
                              expression (src/expandTokenAliases.ml[65,3052+10]..src/expandTokenAliases.ml[65,3052+35])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[65,3052+10]..src/expandTokenAliases.ml[65,3052+24])
                                  Texp_ident "Dune__exe!.StringMap.find"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[65,3052+25]..src/expandTokenAliases.ml[65,3052+26])
                                      Texp_ident "t/723"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[65,3052+27]..src/expandTokenAliases.ml[65,3052+35])
                                      Texp_ident "aliasmap/721"
                                ]
                              [
                                <case>
                                  pattern (src/expandTokenAliases.ml[66,3093+6]..src/expandTokenAliases.ml[66,3093+11])
                                    Tpat_value
                                    pattern (src/expandTokenAliases.ml[66,3093+6]..src/expandTokenAliases.ml[66,3093+11])
                                      Tpat_tuple
                                      [
                                        pattern (src/expandTokenAliases.ml[66,3093+6]..src/expandTokenAliases.ml[66,3093+8])
                                          Tpat_var "id/793"
                                        pattern (src/expandTokenAliases.ml[66,3093+10]..src/expandTokenAliases.ml[66,3093+11])
                                          Tpat_any
                                      ]
                                  expression (src/expandTokenAliases.ml[67,3108+8]..src/expandTokenAliases.ml[67,3108+10])
                                    Texp_ident "id/793"
                                <case>
                                  pattern (src/expandTokenAliases.ml[68,3119+6]..src/expandTokenAliases.ml[68,3119+25])
                                    Tpat_exception
                                    pattern (src/expandTokenAliases.ml[68,3119+16]..src/expandTokenAliases.ml[68,3119+25])
                                      Tpat_construct "Not_found"
                                      []
                                      None
                                  expression (src/expandTokenAliases.ml[69,3148+8]..src/expandTokenAliases.ml[71,3184+52])
                                    Texp_apply
                                    expression (src/expandTokenAliases.ml[69,3148+8]..src/expandTokenAliases.ml[69,3148+19])
                                      Texp_ident "Dune__exe!.Error.error"
                                    [
                                      <arg>
                                        Nolabel
                                        expression (src/expandTokenAliases.ml[70,3168+10]..src/expandTokenAliases.ml[70,3168+15])
                                          Texp_construct "::"
                                          [
                                            expression (src/expandTokenAliases.ml[70,3168+11]..src/expandTokenAliases.ml[70,3168+14])
                                              Texp_ident "pos/722"
                                            expression (src/expandTokenAliases.ml[70,3168+14]..src/expandTokenAliases.ml[70,3168+15]) ghost
                                              Texp_construct "[]"
                                              []
                                          ]
                                      <arg>
                                        Nolabel
                                        expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50])
                                          Texp_construct "CamlinternalFormatBasics.Format"
                                          [
                                            expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                              Texp_construct "CamlinternalFormatBasics.String_literal"
                                              [
                                                expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                  Texp_constant Const_string("the token alias ",(src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost,None)
                                                expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                  Texp_construct "CamlinternalFormatBasics.String"
                                                  [
                                                    expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                      Texp_construct "CamlinternalFormatBasics.No_padding"
                                                      []
                                                    expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                      Texp_construct "CamlinternalFormatBasics.String_literal"
                                                      [
                                                        expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                          Texp_constant Const_string(" was never declared.",(src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost,None)
                                                        expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                                          Texp_construct "CamlinternalFormatBasics.End_of_format"
                                                          []
                                                      ]
                                                  ]
                                              ]
                                            expression (src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost
                                              Texp_constant Const_string("the token alias %s was never declared.",(src/expandTokenAliases.ml[71,3184+10]..src/expandTokenAliases.ml[71,3184+50]) ghost,None)
                                          ]
                                      <arg>
                                        Nolabel
                                        expression (src/expandTokenAliases.ml[71,3184+51]..src/expandTokenAliases.ml[71,3184+52])
                                          Texp_ident "t/723"
                                    ]
                              ]
                            Some
                              expression (src/expandTokenAliases.ml[73,3244+4]..src/expandTokenAliases.ml[73,3244+5])
                                Texp_ident "t/723"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[78,3348+0]..src/expandTokenAliases.ml[79,3413+48])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[78,3348+4]..src/expandTokenAliases.ml[78,3348+18])
          Tpat_var "dealias_symbol/794"
        expression (src/expandTokenAliases.ml[78,3348+19]..src/expandTokenAliases.ml[79,3413+48]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[78,3348+19]..src/expandTokenAliases.ml[78,3348+27])
                Tpat_var "aliasmap/796"
              expression (src/expandTokenAliases.ml[78,3348+28]..src/expandTokenAliases.ml[79,3413+48]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[78,3348+29]..src/expandTokenAliases.ml[78,3348+32])
                      extra
                        Tpat_extra_constraint
                        core_type (src/expandTokenAliases.ml[78,3348+35]..src/expandTokenAliases.ml[78,3348+61])
                          Ttyp_constr "Dune__exe!.Positions.located"
                          [
                            core_type (src/expandTokenAliases.ml[78,3348+35]..src/expandTokenAliases.ml[78,3348+43])
                              Ttyp_constr "Dune__exe!.Syntax.terminal"
                              []
                          ]
                      Tpat_alias "sym/797"
                      pattern (src/expandTokenAliases.ml[78,3348+29]..src/expandTokenAliases.ml[78,3348+32])
                        Tpat_any
                    expression (src/expandTokenAliases.ml[79,3413+2]..src/expandTokenAliases.ml[79,3413+48])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[79,3413+2]..src/expandTokenAliases.ml[79,3413+16])
                        Texp_ident "Dune__exe!.Positions.pmap"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[79,3413+17]..src/expandTokenAliases.ml[79,3413+44])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[79,3413+18]..src/expandTokenAliases.ml[79,3413+34])
                              Texp_ident "dealias_terminal/719"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[79,3413+35]..src/expandTokenAliases.ml[79,3413+43])
                                  Texp_ident "aliasmap/796"
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[79,3413+45]..src/expandTokenAliases.ml[79,3413+48])
                            Texp_ident "sym/797"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[81,3463+0]..src/expandTokenAliases.ml[107,4375+45])
    Tstr_value Rec
    [
      <def>
        pattern (src/expandTokenAliases.ml[81,3463+8]..src/expandTokenAliases.ml[81,3463+25])
          Tpat_var "dealias_parameter/798"
        expression (src/expandTokenAliases.ml[81,3463+26]..src/expandTokenAliases.ml[91,3790+77]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[81,3463+26]..src/expandTokenAliases.ml[81,3463+34])
                Tpat_var "aliasmap/804"
              expression (src/expandTokenAliases.ml[81,3463+35]..src/expandTokenAliases.ml[91,3790+77]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[81,3463+36]..src/expandTokenAliases.ml[81,3463+41])
                      extra
                        Tpat_extra_constraint
                        core_type (src/expandTokenAliases.ml[81,3463+44]..src/expandTokenAliases.ml[81,3463+53])
                          Ttyp_constr "Dune__exe!.Syntax.parameter"
                          []
                      Tpat_alias "param/805"
                      pattern (src/expandTokenAliases.ml[81,3463+36]..src/expandTokenAliases.ml[81,3463+41])
                        Tpat_any
                    expression (src/expandTokenAliases.ml[82,3520+2]..src/expandTokenAliases.ml[91,3790+77])
                      Texp_match
                      expression (src/expandTokenAliases.ml[82,3520+8]..src/expandTokenAliases.ml[82,3520+13])
                        Texp_ident "param/805"
                      [
                        <case>
                          pattern (src/expandTokenAliases.ml[83,3539+4]..src/expandTokenAliases.ml[83,3539+20])
                            Tpat_value
                            pattern (src/expandTokenAliases.ml[83,3539+4]..src/expandTokenAliases.ml[83,3539+20])
                              Tpat_construct "ParameterVar"
                              [
                                pattern (src/expandTokenAliases.ml[83,3539+17]..src/expandTokenAliases.ml[83,3539+20])
                                  Tpat_var "sym/841"
                              ]
                              None
                          expression (src/expandTokenAliases.ml[84,3563+6]..src/expandTokenAliases.ml[84,3563+48])
                            Texp_construct "ParameterVar"
                            [
                              expression (src/expandTokenAliases.ml[84,3563+19]..src/expandTokenAliases.ml[84,3563+48])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[84,3563+20]..src/expandTokenAliases.ml[84,3563+34])
                                  Texp_ident "dealias_symbol/794"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[84,3563+35]..src/expandTokenAliases.ml[84,3563+43])
                                      Texp_ident "aliasmap/804"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[84,3563+44]..src/expandTokenAliases.ml[84,3563+47])
                                      Texp_ident "sym/841"
                                ]
                            ]
                        <case>
                          pattern (src/expandTokenAliases.ml[85,3612+4]..src/expandTokenAliases.ml[85,3612+30])
                            Tpat_value
                            pattern (src/expandTokenAliases.ml[85,3612+4]..src/expandTokenAliases.ml[85,3612+30])
                              Tpat_construct "ParameterApp"
                              [
                                pattern (src/expandTokenAliases.ml[85,3612+18]..src/expandTokenAliases.ml[85,3612+21])
                                  Tpat_var "sym/842"
                                pattern (src/expandTokenAliases.ml[85,3612+23]..src/expandTokenAliases.ml[85,3612+29])
                                  Tpat_var "params/843"
                              ]
                              None
                          expression (src/expandTokenAliases.ml[86,3646+6]..src/expandTokenAliases.ml[89,3747+7])
                            Texp_construct "ParameterApp"
                            [
                              expression (src/expandTokenAliases.ml[87,3667+8]..src/expandTokenAliases.ml[87,3667+35])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[87,3667+8]..src/expandTokenAliases.ml[87,3667+22])
                                  Texp_ident "dealias_symbol/794"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[87,3667+23]..src/expandTokenAliases.ml[87,3667+31])
                                      Texp_ident "aliasmap/804"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[87,3667+32]..src/expandTokenAliases.ml[87,3667+35])
                                      Texp_ident "sym/842"
                                ]
                              expression (src/expandTokenAliases.ml[88,3704+8]..src/expandTokenAliases.ml[88,3704+42])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[88,3704+8]..src/expandTokenAliases.ml[88,3704+26])
                                  Texp_ident "dealias_parameters/799"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[88,3704+27]..src/expandTokenAliases.ml[88,3704+35])
                                      Texp_ident "aliasmap/804"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[88,3704+36]..src/expandTokenAliases.ml[88,3704+42])
                                      Texp_ident "params/843"
                                ]
                            ]
                        <case>
                          pattern (src/expandTokenAliases.ml[90,3755+4]..src/expandTokenAliases.ml[90,3755+31])
                            Tpat_value
                            pattern (src/expandTokenAliases.ml[90,3755+4]..src/expandTokenAliases.ml[90,3755+31])
                              Tpat_construct "ParameterAnonymous"
                              [
                                pattern (src/expandTokenAliases.ml[90,3755+23]..src/expandTokenAliases.ml[90,3755+31])
                                  Tpat_var "branches/844"
                              ]
                              None
                          expression (src/expandTokenAliases.ml[91,3790+6]..src/expandTokenAliases.ml[91,3790+77])
                            Texp_construct "ParameterAnonymous"
                            [
                              expression (src/expandTokenAliases.ml[91,3790+25]..src/expandTokenAliases.ml[91,3790+77])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[91,3790+26]..src/expandTokenAliases.ml[91,3790+39])
                                  Texp_ident "Dune__exe!.Positions.map"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[91,3790+40]..src/expandTokenAliases.ml[91,3790+67])
                                      Texp_apply
                                      expression (src/expandTokenAliases.ml[91,3790+41]..src/expandTokenAliases.ml[91,3790+57])
                                        Texp_ident "dealias_branches/803"
                                      [
                                        <arg>
                                          Nolabel
                                          expression (src/expandTokenAliases.ml[91,3790+58]..src/expandTokenAliases.ml[91,3790+66])
                                            Texp_ident "aliasmap/804"
                                      ]
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[91,3790+68]..src/expandTokenAliases.ml[91,3790+76])
                                      Texp_ident "branches/844"
                                ]
                            ]
                      ]
                ]
          ]
      <def>
        pattern (src/expandTokenAliases.ml[93,3869+4]..src/expandTokenAliases.ml[93,3869+22])
          Tpat_var "dealias_parameters/799"
        expression (src/expandTokenAliases.ml[93,3869+23]..src/expandTokenAliases.ml[94,3910+46]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[93,3869+23]..src/expandTokenAliases.ml[93,3869+31])
                Tpat_var "aliasmap/845"
              expression (src/expandTokenAliases.ml[93,3869+32]..src/expandTokenAliases.ml[94,3910+46]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[93,3869+32]..src/expandTokenAliases.ml[93,3869+38])
                      Tpat_var "params/846"
                    expression (src/expandTokenAliases.ml[94,3910+2]..src/expandTokenAliases.ml[94,3910+46])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[94,3910+2]..src/expandTokenAliases.ml[94,3910+10])
                        Texp_ident "Stdlib!.List.map"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[94,3910+11]..src/expandTokenAliases.ml[94,3910+39])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[94,3910+12]..src/expandTokenAliases.ml[94,3910+29])
                              Texp_ident "dealias_parameter/798"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[94,3910+30]..src/expandTokenAliases.ml[94,3910+38])
                                  Texp_ident "aliasmap/845"
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[94,3910+40]..src/expandTokenAliases.ml[94,3910+46])
                            Texp_ident "params/846"
                      ]
                ]
          ]
      <def>
        pattern (src/expandTokenAliases.ml[96,3958+4]..src/expandTokenAliases.ml[96,3958+20])
          Tpat_var "dealias_producer/800"
        expression (src/expandTokenAliases.ml[96,3958+21]..src/expandTokenAliases.ml[98,4049+47]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[96,3958+21]..src/expandTokenAliases.ml[96,3958+29])
                Tpat_var "aliasmap/847"
              expression (src/expandTokenAliases.ml[96,3958+30]..src/expandTokenAliases.ml[98,4049+47]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[96,3958+31]..src/expandTokenAliases.ml[96,3958+39])
                      extra
                        Tpat_extra_constraint
                        core_type (src/expandTokenAliases.ml[96,3958+42]..src/expandTokenAliases.ml[96,3958+50])
                          Ttyp_constr "Dune__exe!.Syntax.producer"
                          []
                      Tpat_alias "producer/848"
                      pattern (src/expandTokenAliases.ml[96,3958+31]..src/expandTokenAliases.ml[96,3958+39])
                        Tpat_any
                    expression (src/expandTokenAliases.ml[97,4012+2]..src/expandTokenAliases.ml[98,4049+47])
                      Texp_let Nonrec
                      [
                        <def>
                          pattern (src/expandTokenAliases.ml[97,4012+6]..src/expandTokenAliases.ml[97,4012+22])
                            Tpat_tuple
                            [
                              pattern (src/expandTokenAliases.ml[97,4012+6]..src/expandTokenAliases.ml[97,4012+8])
                                Tpat_var "id/849"
                              pattern (src/expandTokenAliases.ml[97,4012+10]..src/expandTokenAliases.ml[97,4012+15])
                                Tpat_var "param/850"
                              pattern (src/expandTokenAliases.ml[97,4012+17]..src/expandTokenAliases.ml[97,4012+22])
                                Tpat_var "attrs/851"
                            ]
                          expression (src/expandTokenAliases.ml[97,4012+25]..src/expandTokenAliases.ml[97,4012+33])
                            Texp_ident "producer/848"
                      ]
                      expression (src/expandTokenAliases.ml[98,4049+2]..src/expandTokenAliases.ml[98,4049+47])
                        Texp_tuple
                        [
                          expression (src/expandTokenAliases.ml[98,4049+2]..src/expandTokenAliases.ml[98,4049+4])
                            Texp_ident "id/849"
                          expression (src/expandTokenAliases.ml[98,4049+6]..src/expandTokenAliases.ml[98,4049+40])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[98,4049+7]..src/expandTokenAliases.ml[98,4049+24])
                              Texp_ident "dealias_parameter/798"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[98,4049+25]..src/expandTokenAliases.ml[98,4049+33])
                                  Texp_ident "aliasmap/847"
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[98,4049+34]..src/expandTokenAliases.ml[98,4049+39])
                                  Texp_ident "param/850"
                            ]
                          expression (src/expandTokenAliases.ml[98,4049+42]..src/expandTokenAliases.ml[98,4049+47])
                            Texp_ident "attrs/851"
                        ]
                ]
          ]
      <def>
        pattern (src/expandTokenAliases.ml[100,4098+4]..src/expandTokenAliases.ml[100,4098+21])
          Tpat_var "dealias_producers/801"
        expression (src/expandTokenAliases.ml[100,4098+22]..src/expandTokenAliases.ml[101,4141+48]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[100,4098+22]..src/expandTokenAliases.ml[100,4098+30])
                Tpat_var "aliasmap/852"
              expression (src/expandTokenAliases.ml[100,4098+31]..src/expandTokenAliases.ml[101,4141+48]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[100,4098+31]..src/expandTokenAliases.ml[100,4098+40])
                      Tpat_var "producers/853"
                    expression (src/expandTokenAliases.ml[101,4141+2]..src/expandTokenAliases.ml[101,4141+48])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[101,4141+2]..src/expandTokenAliases.ml[101,4141+10])
                        Texp_ident "Stdlib!.List.map"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[101,4141+11]..src/expandTokenAliases.ml[101,4141+38])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[101,4141+12]..src/expandTokenAliases.ml[101,4141+28])
                              Texp_ident "dealias_producer/800"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[101,4141+29]..src/expandTokenAliases.ml[101,4141+37])
                                  Texp_ident "aliasmap/852"
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[101,4141+39]..src/expandTokenAliases.ml[101,4141+48])
                            Texp_ident "producers/853"
                      ]
                ]
          ]
      <def>
        pattern (src/expandTokenAliases.ml[103,4191+4]..src/expandTokenAliases.ml[103,4191+18])
          Tpat_var "dealias_branch/802"
        expression (src/expandTokenAliases.ml[103,4191+19]..src/expandTokenAliases.ml[104,4253+79]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[103,4191+19]..src/expandTokenAliases.ml[103,4191+27])
                Tpat_var "aliasmap/854"
              expression (src/expandTokenAliases.ml[103,4191+28]..src/expandTokenAliases.ml[104,4253+79]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[103,4191+29]..src/expandTokenAliases.ml[103,4191+35])
                      extra
                        Tpat_extra_constraint
                        core_type (src/expandTokenAliases.ml[103,4191+38]..src/expandTokenAliases.ml[103,4191+58])
                          Ttyp_constr "Dune__exe!.Syntax.parameterized_branch"
                          []
                      Tpat_alias "branch/855"
                      pattern (src/expandTokenAliases.ml[103,4191+29]..src/expandTokenAliases.ml[103,4191+35])
                        Tpat_any
                    expression (src/expandTokenAliases.ml[104,4253+2]..src/expandTokenAliases.ml[104,4253+79])
                      Texp_record
                        fields =
                          [
                            <kept>                            "pr_producers"
                              expression (src/expandTokenAliases.ml[104,4253+31]..src/expandTokenAliases.ml[104,4253+77])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[104,4253+31]..src/expandTokenAliases.ml[104,4253+48])
                                  Texp_ident "dealias_producers/801"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[104,4253+49]..src/expandTokenAliases.ml[104,4253+57])
                                      Texp_ident "aliasmap/854"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[104,4253+58]..src/expandTokenAliases.ml[104,4253+77])
                                      Texp_field
                                      expression (src/expandTokenAliases.ml[104,4253+58]..src/expandTokenAliases.ml[104,4253+64])
                                        Texp_ident "branch/855"
                                      "pr_producers"
                                ]
                            <kept>                            <kept>                            <kept>                          ]
                        representation =
                          Record_regular
                        extended_expression =
                          Some
                            expression (src/expandTokenAliases.ml[104,4253+4]..src/expandTokenAliases.ml[104,4253+10])
                              Texp_ident "branch/855"
                ]
          ]
      <def>
        pattern (src/expandTokenAliases.ml[106,4334+4]..src/expandTokenAliases.ml[106,4334+20])
          Tpat_var "dealias_branches/803"
        expression (src/expandTokenAliases.ml[106,4334+21]..src/expandTokenAliases.ml[107,4375+45]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[106,4334+21]..src/expandTokenAliases.ml[106,4334+29])
                Tpat_var "aliasmap/856"
              expression (src/expandTokenAliases.ml[106,4334+30]..src/expandTokenAliases.ml[107,4375+45]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[106,4334+30]..src/expandTokenAliases.ml[106,4334+38])
                      Tpat_var "branches/857"
                    expression (src/expandTokenAliases.ml[107,4375+2]..src/expandTokenAliases.ml[107,4375+45])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[107,4375+2]..src/expandTokenAliases.ml[107,4375+10])
                        Texp_ident "Stdlib!.List.map"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[107,4375+11]..src/expandTokenAliases.ml[107,4375+36])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[107,4375+12]..src/expandTokenAliases.ml[107,4375+26])
                              Texp_ident "dealias_branch/802"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[107,4375+27]..src/expandTokenAliases.ml[107,4375+35])
                                  Texp_ident "aliasmap/856"
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[107,4375+37]..src/expandTokenAliases.ml[107,4375+45])
                            Texp_ident "branches/857"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[109,4422+0]..src/expandTokenAliases.ml[110,4455+72])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[109,4422+4]..src/expandTokenAliases.ml[109,4422+16])
          Tpat_var "dealias_rule/858"
        expression (src/expandTokenAliases.ml[109,4422+17]..src/expandTokenAliases.ml[110,4455+72]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[109,4422+17]..src/expandTokenAliases.ml[109,4422+25])
                Tpat_var "aliasmap/860"
              expression (src/expandTokenAliases.ml[109,4422+26]..src/expandTokenAliases.ml[110,4455+72]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[109,4422+26]..src/expandTokenAliases.ml[109,4422+30])
                      Tpat_var "rule/861"
                    expression (src/expandTokenAliases.ml[110,4455+2]..src/expandTokenAliases.ml[110,4455+72])
                      Texp_record
                        fields =
                          [
                            <kept>                            <kept>                            <kept>                            <kept>                            <kept>                            <kept>                            "pr_branches"
                              expression (src/expandTokenAliases.ml[110,4455+28]..src/expandTokenAliases.ml[110,4455+70])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[110,4455+28]..src/expandTokenAliases.ml[110,4455+44])
                                  Texp_ident "dealias_branches/803"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[110,4455+45]..src/expandTokenAliases.ml[110,4455+53])
                                      Texp_ident "aliasmap/860"
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[110,4455+54]..src/expandTokenAliases.ml[110,4455+70])
                                      Texp_field
                                      expression (src/expandTokenAliases.ml[110,4455+54]..src/expandTokenAliases.ml[110,4455+58])
                                        Texp_ident "rule/861"
                                      "pr_branches"
                                ]
                          ]
                        representation =
                          Record_regular
                        extended_expression =
                          Some
                            expression (src/expandTokenAliases.ml[110,4455+4]..src/expandTokenAliases.ml[110,4455+8])
                              Texp_ident "rule/861"
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[112,4529+0]..src/expandTokenAliases.ml[129,5183+8])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[112,4529+4]..src/expandTokenAliases.ml[112,4529+16])
          Tpat_var "dealias_decl/862"
        expression (src/expandTokenAliases.ml[112,4529+17]..src/expandTokenAliases.ml[129,5183+8]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[112,4529+17]..src/expandTokenAliases.ml[112,4529+25])
                Tpat_var "aliasmap/864"
              expression (src/expandTokenAliases.ml[112,4529+26]..src/expandTokenAliases.ml[129,5183+8]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[112,4529+27]..src/expandTokenAliases.ml[112,4529+31])
                      extra
                        Tpat_extra_constraint
                        core_type (src/expandTokenAliases.ml[112,4529+34]..src/expandTokenAliases.ml[112,4529+63])
                          Ttyp_constr "Dune__exe!.Positions.located"
                          [
                            core_type (src/expandTokenAliases.ml[112,4529+34]..src/expandTokenAliases.ml[112,4529+45])
                              Ttyp_constr "Dune__exe!.Syntax.declaration"
                              []
                          ]
                      Tpat_alias "decl/865"
                      pattern (src/expandTokenAliases.ml[112,4529+27]..src/expandTokenAliases.ml[112,4529+31])
                        Tpat_any
                    expression (src/expandTokenAliases.ml[113,4596+2]..src/expandTokenAliases.ml[129,5183+8])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[113,4596+2]..src/expandTokenAliases.ml[113,4596+16])
                        Texp_ident "Dune__exe!.Positions.pmap"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[113,4596+17]..src/expandTokenAliases.ml[129,5183+3])
                            Texp_function
                            Nolabel
                            [
                              <case>
                                pattern (src/expandTokenAliases.ml[113,4596+22]..src/expandTokenAliases.ml[113,4596+25])
                                  Tpat_var "pos/866"
                                expression (src/expandTokenAliases.ml[113,4596+26]..src/expandTokenAliases.ml[128,5118+64]) ghost
                                  Texp_function
                                  Nolabel
                                  [
                                    <case>
                                      pattern (src/expandTokenAliases.ml[113,4596+27]..src/expandTokenAliases.ml[113,4596+31])
                                        extra
                                          Tpat_extra_constraint
                                          core_type (src/expandTokenAliases.ml[113,4596+34]..src/expandTokenAliases.ml[113,4596+45])
                                            Ttyp_constr "Dune__exe!.Syntax.declaration"
                                            []
                                        Tpat_alias "decl/867"
                                        pattern (src/expandTokenAliases.ml[113,4596+27]..src/expandTokenAliases.ml[113,4596+31])
                                          Tpat_any
                                      expression (src/expandTokenAliases.ml[114,4646+4]..src/expandTokenAliases.ml[128,5118+64])
                                        Texp_match
                                        expression (src/expandTokenAliases.ml[114,4646+10]..src/expandTokenAliases.ml[114,4646+14])
                                          Texp_ident "decl/867"
                                        [
                                          <case>
                                            pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[119,4729+25])
                                              Tpat_or
                                              pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[118,4714+14])
                                                Tpat_or
                                                pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[117,4699+14])
                                                  Tpat_or
                                                  pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[116,4680+18])
                                                    Tpat_or
                                                    pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[115,4666+13])
                                                      Tpat_value
                                                      pattern (src/expandTokenAliases.ml[115,4666+6]..src/expandTokenAliases.ml[115,4666+13])
                                                        Tpat_construct "DCode"
                                                        [
                                                          pattern (src/expandTokenAliases.ml[115,4666+12]..src/expandTokenAliases.ml[115,4666+13])
                                                            Tpat_any
                                                        ]
                                                        None
                                                    pattern (src/expandTokenAliases.ml[116,4680+6]..src/expandTokenAliases.ml[116,4680+18])
                                                      Tpat_value
                                                      pattern (src/expandTokenAliases.ml[116,4680+6]..src/expandTokenAliases.ml[116,4680+18])
                                                        Tpat_construct "DParameter"
                                                        [
                                                          pattern (src/expandTokenAliases.ml[116,4680+17]..src/expandTokenAliases.ml[116,4680+18])
                                                            Tpat_any
                                                        ]
                                                        None
                                                  pattern (src/expandTokenAliases.ml[117,4699+6]..src/expandTokenAliases.ml[117,4699+14])
                                                    Tpat_value
                                                    pattern (src/expandTokenAliases.ml[117,4699+6]..src/expandTokenAliases.ml[117,4699+14])
                                                      Tpat_construct "DToken"
                                                      [
                                                        pattern (src/expandTokenAliases.ml[117,4699+13]..src/expandTokenAliases.ml[117,4699+14])
                                                          Tpat_any
                                                        pattern (src/expandTokenAliases.ml[117,4699+13]..src/expandTokenAliases.ml[117,4699+14])
                                                          Tpat_any
                                                        pattern (src/expandTokenAliases.ml[117,4699+13]..src/expandTokenAliases.ml[117,4699+14])
                                                          Tpat_any
                                                        pattern (src/expandTokenAliases.ml[117,4699+13]..src/expandTokenAliases.ml[117,4699+14])
                                                          Tpat_any
                                                      ]
                                                      None
                                                pattern (src/expandTokenAliases.ml[118,4714+6]..src/expandTokenAliases.ml[118,4714+14])
                                                  Tpat_value
                                                  pattern (src/expandTokenAliases.ml[118,4714+6]..src/expandTokenAliases.ml[118,4714+14])
                                                    Tpat_construct "DStart"
                                                    [
                                                      pattern (src/expandTokenAliases.ml[118,4714+13]..src/expandTokenAliases.ml[118,4714+14])
                                                        Tpat_any
                                                    ]
                                                    None
                                              pattern (src/expandTokenAliases.ml[119,4729+6]..src/expandTokenAliases.ml[119,4729+25])
                                                Tpat_value
                                                pattern (src/expandTokenAliases.ml[119,4729+6]..src/expandTokenAliases.ml[119,4729+25])
                                                  Tpat_construct "DGrammarAttribute"
                                                  [
                                                    pattern (src/expandTokenAliases.ml[119,4729+24]..src/expandTokenAliases.ml[119,4729+25])
                                                      Tpat_any
                                                  ]
                                                  None
                                            expression (src/expandTokenAliases.ml[120,4758+8]..src/expandTokenAliases.ml[120,4758+12])
                                              Texp_ident "decl/867"
                                          <case>
                                            pattern (src/expandTokenAliases.ml[121,4771+6]..src/expandTokenAliases.ml[121,4771+39])
                                              Tpat_value
                                              pattern (src/expandTokenAliases.ml[121,4771+6]..src/expandTokenAliases.ml[121,4771+39])
                                                Tpat_construct "DTokenProperties"
                                                [
                                                  pattern (src/expandTokenAliases.ml[121,4771+24]..src/expandTokenAliases.ml[121,4771+25])
                                                    Tpat_var "t/868"
                                                  pattern (src/expandTokenAliases.ml[121,4771+27]..src/expandTokenAliases.ml[121,4771+32])
                                                    Tpat_var "assoc/869"
                                                  pattern (src/expandTokenAliases.ml[121,4771+34]..src/expandTokenAliases.ml[121,4771+38])
                                                    Tpat_var "prec/870"
                                                ]
                                                None
                                            expression (src/expandTokenAliases.ml[122,4814+8]..src/expandTokenAliases.ml[122,4814+71])
                                              Texp_construct "DTokenProperties"
                                              [
                                                expression (src/expandTokenAliases.ml[122,4814+26]..src/expandTokenAliases.ml[122,4814+57])
                                                  Texp_apply
                                                  expression (src/expandTokenAliases.ml[122,4814+26]..src/expandTokenAliases.ml[122,4814+42])
                                                    Texp_ident "dealias_terminal/719"
                                                  [
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[122,4814+43]..src/expandTokenAliases.ml[122,4814+51])
                                                        Texp_ident "aliasmap/864"
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[122,4814+52]..src/expandTokenAliases.ml[122,4814+55])
                                                        Texp_ident "pos/866"
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[122,4814+56]..src/expandTokenAliases.ml[122,4814+57])
                                                        Texp_ident "t/868"
                                                  ]
                                                expression (src/expandTokenAliases.ml[122,4814+59]..src/expandTokenAliases.ml[122,4814+64])
                                                  Texp_ident "assoc/869"
                                                expression (src/expandTokenAliases.ml[122,4814+66]..src/expandTokenAliases.ml[122,4814+70])
                                                  Texp_ident "prec/870"
                                              ]
                                          <case>
                                            pattern (src/expandTokenAliases.ml[123,4886+6]..src/expandTokenAliases.ml[123,4886+23])
                                              Tpat_value
                                              pattern (src/expandTokenAliases.ml[123,4886+6]..src/expandTokenAliases.ml[123,4886+23])
                                                Tpat_construct "DType"
                                                [
                                                  pattern (src/expandTokenAliases.ml[123,4886+13]..src/expandTokenAliases.ml[123,4886+15])
                                                    Tpat_var "ty/871"
                                                  pattern (src/expandTokenAliases.ml[123,4886+17]..src/expandTokenAliases.ml[123,4886+22])
                                                    Tpat_var "param/872"
                                                ]
                                                None
                                            expression (src/expandTokenAliases.ml[124,4913+8]..src/expandTokenAliases.ml[124,4913+52])
                                              Texp_construct "DType"
                                              [
                                                expression (src/expandTokenAliases.ml[124,4913+15]..src/expandTokenAliases.ml[124,4913+17])
                                                  Texp_ident "ty/871"
                                                expression (src/expandTokenAliases.ml[124,4913+19]..src/expandTokenAliases.ml[124,4913+51])
                                                  Texp_apply
                                                  expression (src/expandTokenAliases.ml[124,4913+19]..src/expandTokenAliases.ml[124,4913+36])
                                                    Texp_ident "dealias_parameter/798"
                                                  [
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[124,4913+37]..src/expandTokenAliases.ml[124,4913+45])
                                                        Texp_ident "aliasmap/864"
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[124,4913+46]..src/expandTokenAliases.ml[124,4913+51])
                                                        Texp_ident "param/872"
                                                  ]
                                              ]
                                          <case>
                                            pattern (src/expandTokenAliases.ml[125,4966+6]..src/expandTokenAliases.ml[125,4966+39])
                                              Tpat_value
                                              pattern (src/expandTokenAliases.ml[125,4966+6]..src/expandTokenAliases.ml[125,4966+39])
                                                Tpat_construct "DSymbolAttributes"
                                                [
                                                  pattern (src/expandTokenAliases.ml[125,4966+25]..src/expandTokenAliases.ml[125,4966+31])
                                                    Tpat_var "params/873"
                                                  pattern (src/expandTokenAliases.ml[125,4966+33]..src/expandTokenAliases.ml[125,4966+38])
                                                    Tpat_var "attrs/874"
                                                ]
                                                None
                                            expression (src/expandTokenAliases.ml[126,5009+8]..src/expandTokenAliases.ml[126,5009+69])
                                              Texp_construct "DSymbolAttributes"
                                              [
                                                expression (src/expandTokenAliases.ml[126,5009+27]..src/expandTokenAliases.ml[126,5009+61])
                                                  Texp_apply
                                                  expression (src/expandTokenAliases.ml[126,5009+27]..src/expandTokenAliases.ml[126,5009+45])
                                                    Texp_ident "dealias_parameters/799"
                                                  [
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[126,5009+46]..src/expandTokenAliases.ml[126,5009+54])
                                                        Texp_ident "aliasmap/864"
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[126,5009+55]..src/expandTokenAliases.ml[126,5009+61])
                                                        Texp_ident "params/873"
                                                  ]
                                                expression (src/expandTokenAliases.ml[126,5009+63]..src/expandTokenAliases.ml[126,5009+68])
                                                  Texp_ident "attrs/874"
                                              ]
                                          <case>
                                            pattern (src/expandTokenAliases.ml[127,5079+6]..src/expandTokenAliases.ml[127,5079+35])
                                              Tpat_value
                                              pattern (src/expandTokenAliases.ml[127,5079+6]..src/expandTokenAliases.ml[127,5079+35])
                                                Tpat_construct "DOnErrorReduce"
                                                [
                                                  pattern (src/expandTokenAliases.ml[127,5079+22]..src/expandTokenAliases.ml[127,5079+27])
                                                    Tpat_var "param/875"
                                                  pattern (src/expandTokenAliases.ml[127,5079+29]..src/expandTokenAliases.ml[127,5079+34])
                                                    Tpat_var "level/876"
                                                ]
                                                None
                                            expression (src/expandTokenAliases.ml[128,5118+8]..src/expandTokenAliases.ml[128,5118+64])
                                              Texp_construct "DOnErrorReduce"
                                              [
                                                expression (src/expandTokenAliases.ml[128,5118+24]..src/expandTokenAliases.ml[128,5118+56])
                                                  Texp_apply
                                                  expression (src/expandTokenAliases.ml[128,5118+24]..src/expandTokenAliases.ml[128,5118+41])
                                                    Texp_ident "dealias_parameter/798"
                                                  [
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[128,5118+42]..src/expandTokenAliases.ml[128,5118+50])
                                                        Texp_ident "aliasmap/864"
                                                    <arg>
                                                      Nolabel
                                                      expression (src/expandTokenAliases.ml[128,5118+51]..src/expandTokenAliases.ml[128,5118+56])
                                                        Texp_ident "param/875"
                                                  ]
                                                expression (src/expandTokenAliases.ml[128,5118+58]..src/expandTokenAliases.ml[128,5118+63])
                                                  Texp_ident "level/876"
                                              ]
                                        ]
                                  ]
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[129,5183+4]..src/expandTokenAliases.ml[129,5183+8])
                            Texp_ident "decl/865"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[131,5193+0]..src/expandTokenAliases.ml[134,5311+60])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[131,5193+4]..src/expandTokenAliases.ml[131,5193+19])
          Tpat_var "dealias_grammar/897"
        expression (src/expandTokenAliases.ml[131,5193+20]..src/expandTokenAliases.ml[134,5311+60]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[131,5193+20]..src/expandTokenAliases.ml[131,5193+28])
                Tpat_var "aliasmap/899"
              expression (src/expandTokenAliases.ml[131,5193+29]..src/expandTokenAliases.ml[134,5311+60]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[131,5193+29]..src/expandTokenAliases.ml[131,5193+30])
                      Tpat_var "g/900"
                    expression (src/expandTokenAliases.ml[132,5226+2]..src/expandTokenAliases.ml[134,5311+60])
                      Texp_record
                        fields =
                          [
                            <kept>                            <kept>                            "pg_declarations"
                              expression (src/expandTokenAliases.ml[133,5237+22]..src/expandTokenAliases.ml[133,5237+72])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[133,5237+22]..src/expandTokenAliases.ml[133,5237+30])
                                  Texp_ident "Stdlib!.List.map"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[133,5237+31]..src/expandTokenAliases.ml[133,5237+54])
                                      Texp_apply
                                      expression (src/expandTokenAliases.ml[133,5237+32]..src/expandTokenAliases.ml[133,5237+44])
                                        Texp_ident "dealias_decl/862"
                                      [
                                        <arg>
                                          Nolabel
                                          expression (src/expandTokenAliases.ml[133,5237+45]..src/expandTokenAliases.ml[133,5237+53])
                                            Texp_ident "aliasmap/899"
                                      ]
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[133,5237+55]..src/expandTokenAliases.ml[133,5237+72])
                                      Texp_field
                                      expression (src/expandTokenAliases.ml[133,5237+55]..src/expandTokenAliases.ml[133,5237+56])
                                        Texp_ident "g/900"
                                      "pg_declarations"
                                ]
                            "pg_rules"
                              expression (src/expandTokenAliases.ml[134,5311+15]..src/expandTokenAliases.ml[134,5311+58])
                                Texp_apply
                                expression (src/expandTokenAliases.ml[134,5311+15]..src/expandTokenAliases.ml[134,5311+23])
                                  Texp_ident "Stdlib!.List.map"
                                [
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[134,5311+24]..src/expandTokenAliases.ml[134,5311+47])
                                      Texp_apply
                                      expression (src/expandTokenAliases.ml[134,5311+25]..src/expandTokenAliases.ml[134,5311+37])
                                        Texp_ident "dealias_rule/858"
                                      [
                                        <arg>
                                          Nolabel
                                          expression (src/expandTokenAliases.ml[134,5311+38]..src/expandTokenAliases.ml[134,5311+46])
                                            Texp_ident "aliasmap/899"
                                      ]
                                  <arg>
                                    Nolabel
                                    expression (src/expandTokenAliases.ml[134,5311+48]..src/expandTokenAliases.ml[134,5311+58])
                                      Texp_field
                                      expression (src/expandTokenAliases.ml[134,5311+48]..src/expandTokenAliases.ml[134,5311+49])
                                        Texp_ident "g/900"
                                      "pg_rules"
                                ]
                          ]
                        representation =
                          Record_regular
                        extended_expression =
                          Some
                            expression (src/expandTokenAliases.ml[132,5226+4]..src/expandTokenAliases.ml[132,5226+5])
                              Texp_ident "g/900"
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[136,5373+0]..src/expandTokenAliases.ml[137,5408+40])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[136,5373+4]..src/expandTokenAliases.ml[136,5373+20])
          Tpat_var "dealias_grammars/901"
        expression (src/expandTokenAliases.ml[136,5373+21]..src/expandTokenAliases.ml[137,5408+40]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[136,5373+21]..src/expandTokenAliases.ml[136,5373+29])
                Tpat_var "aliasmap/903"
              expression (src/expandTokenAliases.ml[136,5373+30]..src/expandTokenAliases.ml[137,5408+40]) ghost
                Texp_function
                Nolabel
                [
                  <case>
                    pattern (src/expandTokenAliases.ml[136,5373+30]..src/expandTokenAliases.ml[136,5373+32])
                      Tpat_var "gs/904"
                    expression (src/expandTokenAliases.ml[137,5408+2]..src/expandTokenAliases.ml[137,5408+40])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[137,5408+2]..src/expandTokenAliases.ml[137,5408+10])
                        Texp_ident "Stdlib!.List.map"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[137,5408+11]..src/expandTokenAliases.ml[137,5408+37])
                            Texp_apply
                            expression (src/expandTokenAliases.ml[137,5408+12]..src/expandTokenAliases.ml[137,5408+27])
                              Texp_ident "dealias_grammar/897"
                            [
                              <arg>
                                Nolabel
                                expression (src/expandTokenAliases.ml[137,5408+28]..src/expandTokenAliases.ml[137,5408+36])
                                  Texp_ident "aliasmap/903"
                            ]
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[137,5408+38]..src/expandTokenAliases.ml[137,5408+40])
                            Texp_ident "gs/904"
                      ]
                ]
          ]
    ]
  structure_item (src/expandTokenAliases.ml[143,5585+0]..src/expandTokenAliases.ml[145,5664+30])
    Tstr_value Nonrec
    [
      <def>
        pattern (src/expandTokenAliases.ml[143,5585+4]..src/expandTokenAliases.ml[143,5585+20])
          Tpat_var "dealias_grammars/905"
        expression (src/expandTokenAliases.ml[143,5585+21]..src/expandTokenAliases.ml[145,5664+30]) ghost
          Texp_function
          Nolabel
          [
            <case>
              pattern (src/expandTokenAliases.ml[143,5585+21]..src/expandTokenAliases.ml[143,5585+23])
                Tpat_var "gs/906"
              expression (src/expandTokenAliases.ml[144,5611+2]..src/expandTokenAliases.ml[145,5664+30])
                Texp_let Nonrec
                [
                  <def>
                    pattern (src/expandTokenAliases.ml[144,5611+6]..src/expandTokenAliases.ml[144,5611+14])
                      Tpat_var "aliasmap/907"
                    expression (src/expandTokenAliases.ml[144,5611+17]..src/expandTokenAliases.ml[144,5611+49])
                      Texp_apply
                      expression (src/expandTokenAliases.ml[144,5611+17]..src/expandTokenAliases.ml[144,5611+46])
                        Texp_ident "collect_aliases_from_grammars/716"
                      [
                        <arg>
                          Nolabel
                          expression (src/expandTokenAliases.ml[144,5611+47]..src/expandTokenAliases.ml[144,5611+49])
                            Texp_ident "gs/906"
                      ]
                ]
                expression (src/expandTokenAliases.ml[145,5664+2]..src/expandTokenAliases.ml[145,5664+30])
                  Texp_apply
                  expression (src/expandTokenAliases.ml[145,5664+2]..src/expandTokenAliases.ml[145,5664+18])
                    Texp_ident "dealias_grammars/901"
                  [
                    <arg>
                      Nolabel
                      expression (src/expandTokenAliases.ml[145,5664+19]..src/expandTokenAliases.ml[145,5664+27])
                        Texp_ident "aliasmap/907"
                    <arg>
                      Nolabel
                      expression (src/expandTokenAliases.ml[145,5664+28]..src/expandTokenAliases.ml[145,5664+30])
                        Texp_ident "gs/906"
                  ]
          ]
    ]
]

{<Dune__exe__ExpandTokenAliases>
 "dealias_grammars"[value] -> <Dune__exe__ExpandTokenAliases.69>;
 }

(seq
  (let
    (collect_aliases_from_declaration/598 =
       (function aliasmap/600 decl/601
         (let
           (*match*/1432 =
              (apply (field_imm 0 (global Dune__exe__Positions!)) decl/601))
           (catch
             (switch *match*/1432
              case tag 2:
               (let (*match*/1434 =a (field_imm 2 *match*/1432))
                 (if (isint *match*/1434) (exit 3)
                   (let
                     (*match*/1435 =a (field_imm 3 *match*/1432)
                      qid/603 =a (field_imm 0 *match*/1434)
                      id/602 =a (field_imm 1 *match*/1432)
                      *match*/1433 =a (field_imm 0 *match*/1432))
                     (catch
                       (try
                         (exit 1
                           (apply
                             (field_imm 15 (global Dune__exe__StringMap!))
                             qid/603 aliasmap/600))
                        with exn/1431
                         (catch
                           (if (== exn/1431 (field_imm 7 (global Stdlib!)))
                             (apply
                               (field_imm 1 (global Dune__exe__StringMap!))
                               qid/603
                               (makeblock 0 id/602
                                 (apply
                                   (field_imm 1
                                     (global Dune__exe__Positions!))
                                   decl/601))
                               aliasmap/600)
                             (exit 2))
                          with (2) (reraise exn/1431)))
                      with (1 val/1430)
                       (let
                         (pos/605 =a (field_imm 1 val/1430)
                          id0/604 =a (field_imm 0 val/1430))
                         (apply (field_imm 5 (global Dune__exe__Error!))
                           (makeblock 0
                             (apply
                               (field_imm 1 (global Dune__exe__Positions!))
                               decl/601)
                             (makeblock 0 pos/605 0))
                           [0:
                            [2:
                             0
                             [11:
                              " cannot be declared as an alias for the symbol "
                              [2:
                               0
                               [11:
                                ".\nIt has already been declared as an alias for "
                                [2: 0 [12: '.' 0]]]]]]
                            "%s cannot be declared as an alias for the symbol %s.\nIt has already been declared as an alias for %s."]
                           qid/603 id/602 id0/604))))))
              default: (exit 3))
            with (3) aliasmap/600))))
    (setfield_ptr(root-init) 1 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_declaration/598))
  (let
    (collect_aliases_from_grammar/646 =
       (function aliasmap/648 g/649
         (apply (field_imm 25 (global Stdlib__List!))
           (field_imm 1 (global Dune__exe__ExpandTokenAliases!)) aliasmap/648
           (field_imm 2 g/649))))
    (setfield_ptr(root-init) 2 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_grammar/646))
  (let
    (collect_aliases_from_grammars/716 =
       (function gs/718
         (apply (field_imm 25 (global Stdlib__List!))
           (field_imm 2 (global Dune__exe__ExpandTokenAliases!))
           (field_imm 0 (global Dune__exe__StringMap!)) gs/718)))
    (setfield_ptr(root-init) 3 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_grammars/716))
  (let
    (dealias_terminal/719 =
       (function aliasmap/721 pos/722 t/723
         (if (== (string.get t/723 0) '"')
           (catch
             (try
               (exit 4
                 (apply (field_imm 15 (global Dune__exe__StringMap!)) t/723
                   aliasmap/721))
              with exn/1438
               (catch
                 (if (== exn/1438 (field_imm 7 (global Stdlib!)))
                   (apply (field_imm 5 (global Dune__exe__Error!))
                     (makeblock 0 pos/722 0)
                     [0:
                      [11:
                       "the token alias "
                       [2: 0 [11: " was never declared." 0]]]
                      "the token alias %s was never declared."]
                     t/723)
                   (exit 5))
                with (5) (reraise exn/1438)))
            with (4 val/1436)
             (let
               (*match*/1437 =a (field_imm 1 val/1436)
                id/793 =a (field_imm 0 val/1436))
               id/793))
           t/723)))
    (setfield_ptr(root-init) 4 (global Dune__exe__ExpandTokenAliases!)
      dealias_terminal/719))
  (let
    (dealias_symbol/794 =
       (function aliasmap/796 sym/797
         (apply (field_imm 8 (global Dune__exe__Positions!))
           (apply (field_imm 4 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/796)
           sym/797)))
    (setfield_ptr(root-init) 5 (global Dune__exe__ExpandTokenAliases!)
      dealias_symbol/794))
  (letrec
    (dealias_parameter/798
       (function aliasmap/804 param/805
         (switch* param/805
          case tag 0:
           (let (sym/841 =a (field_imm 0 param/805))
             (makeblock 0
               (apply (field_imm 5 (global Dune__exe__ExpandTokenAliases!))
                 aliasmap/804 sym/841)))
          case tag 1:
           (let
             (params/843 =a (field_imm 1 param/805)
              sym/842 =a (field_imm 0 param/805))
             (makeblock 1
               (apply (field_imm 5 (global Dune__exe__ExpandTokenAliases!))
                 aliasmap/804 sym/842)
               (apply dealias_parameters/799 aliasmap/804 params/843)))
          case tag 2:
           (let (branches/844 =a (field_imm 0 param/805))
             (makeblock 2
               (apply (field_imm 7 (global Dune__exe__Positions!))
                 (apply dealias_branches/803 aliasmap/804) branches/844)))))
      dealias_parameters/799
        (function aliasmap/845 params/846
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_parameter/798 aliasmap/845) params/846))
      dealias_producer/800
        (function aliasmap/847 producer/848
          (let
            (attrs/851 =a (field_imm 2 producer/848)
             param/850 =a (field_imm 1 producer/848)
             id/849 =a (field_imm 0 producer/848))
            (makeblock 0 id/849
              (apply dealias_parameter/798 aliasmap/847 param/850) attrs/851)))
      dealias_producers/801
        (function aliasmap/852 producers/853
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_producer/800 aliasmap/852) producers/853))
      dealias_branch/802
        (function aliasmap/854 branch/855
          (let (init/1442 = branch/855)
            (makeblock 0 (field_imm 0 init/1442)
              (apply dealias_producers/801 aliasmap/854
                (field_imm 1 branch/855))
              (field_imm 2 init/1442) (field_imm 3 init/1442)
              (field_imm 4 init/1442))))
      dealias_branches/803
        (function aliasmap/856 branches/857
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_branch/802 aliasmap/856) branches/857)))
    (seq
      (setfield_ptr(root-init) 6 (global Dune__exe__ExpandTokenAliases!)
        dealias_parameter/798)
      (setfield_ptr(root-init) 7 (global Dune__exe__ExpandTokenAliases!)
        dealias_parameters/799)
      (setfield_ptr(root-init) 8 (global Dune__exe__ExpandTokenAliases!)
        dealias_producer/800)
      (setfield_ptr(root-init) 9 (global Dune__exe__ExpandTokenAliases!)
        dealias_producers/801)
      (setfield_ptr(root-init) 10 (global Dune__exe__ExpandTokenAliases!)
        dealias_branch/802)
      (setfield_ptr(root-init) 11 (global Dune__exe__ExpandTokenAliases!)
        dealias_branches/803)))
  (let
    (dealias_rule/858 =
       (function aliasmap/860 rule/861
         (let (init/1443 = rule/861)
           (makeblock 0 (int,int,*,*,*,*,*) (field_int 0 init/1443)
             (field_int 1 init/1443) (field_imm 2 init/1443)
             (field_imm 3 init/1443) (field_imm 4 init/1443)
             (field_imm 5 init/1443)
             (apply (field_imm 11 (global Dune__exe__ExpandTokenAliases!))
               aliasmap/860 (field_imm 6 rule/861))))))
    (setfield_ptr(root-init) 12 (global Dune__exe__ExpandTokenAliases!)
      dealias_rule/858))
  (let
    (dealias_decl/862 =
       (function aliasmap/864 decl/865
         (apply (field_imm 8 (global Dune__exe__Positions!))
           (function pos/866 decl/867
             (catch
               (switch decl/867
                case tag 4:
                 (let
                   (prec/870 =a (field_imm 2 decl/867)
                    assoc/869 =a (field_imm 1 decl/867)
                    t/868 =a (field_imm 0 decl/867))
                   (makeblock 4 (*,int,*)
                     (apply
                       (field_imm 4 (global Dune__exe__ExpandTokenAliases!))
                       aliasmap/864 pos/866 t/868)
                     assoc/869 prec/870))
                case tag 5:
                 (let
                   (param/872 =a (field_imm 1 decl/867)
                    ty/871 =a (field_imm 0 decl/867))
                   (makeblock 5 ty/871
                     (apply
                       (field_imm 6 (global Dune__exe__ExpandTokenAliases!))
                       aliasmap/864 param/872)))
                case tag 7:
                 (let
                   (attrs/874 =a (field_imm 1 decl/867)
                    params/873 =a (field_imm 0 decl/867))
                   (makeblock 7
                     (apply
                       (field_imm 7 (global Dune__exe__ExpandTokenAliases!))
                       aliasmap/864 params/873)
                     attrs/874))
                case tag 8:
                 (let
                   (level/876 =a (field_imm 1 decl/867)
                    param/875 =a (field_imm 0 decl/867))
                   (makeblock 8
                     (apply
                       (field_imm 6 (global Dune__exe__ExpandTokenAliases!))
                       aliasmap/864 param/875)
                     level/876))
                default: (exit 9))
              with (9) decl/867))
           decl/865)))
    (setfield_ptr(root-init) 13 (global Dune__exe__ExpandTokenAliases!)
      dealias_decl/862))
  (let
    (dealias_grammar/897 =
       (function aliasmap/899 g/900
         (let (init/1452 = g/900)
           (makeblock 0 (field_imm 0 init/1452) (field_imm 1 init/1452)
             (apply (field_imm 19 (global Stdlib__List!))
               (apply (field_imm 13 (global Dune__exe__ExpandTokenAliases!))
                 aliasmap/899)
               (field_imm 2 g/900))
             (apply (field_imm 19 (global Stdlib__List!))
               (apply (field_imm 12 (global Dune__exe__ExpandTokenAliases!))
                 aliasmap/899)
               (field_imm 3 g/900))))))
    (setfield_ptr(root-init) 14 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammar/897))
  (let
    (dealias_grammars/901 =
       (function aliasmap/903 gs/904
         (apply (field_imm 19 (global Stdlib__List!))
           (apply (field_imm 14 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/903)
           gs/904)))
    (setfield_ptr(root-init) 15 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammars/901))
  (let
    (dealias_grammars/905 =
       (function gs/906
         (let
           (aliasmap/907 =
              (apply (field_imm 3 (global Dune__exe__ExpandTokenAliases!))
                gs/906))
           (apply (field_imm 15 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/907 gs/906))))
    (setfield_ptr(root-init) 0 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammars/905))
  0)
(seq
  (let
    (collect_aliases_from_declaration/598 =
       (function aliasmap/600 decl/601
         (let
           (*match*/1432 =
              (apply (field_imm 0 (global Dune__exe__Positions!)) decl/601))
           (catch
             (switch *match*/1432
              case tag 2:
               (let (*match*/1434 =a (field_imm 2 *match*/1432))
                 (if (isint *match*/1434) (exit 3)
                   (let
                     (qid/603 =a (field_imm 0 *match*/1434)
                      id/602 =a (field_imm 1 *match*/1432))
                     (catch
                       (try
                         (exit 1
                           (apply
                             (field_imm 15 (global Dune__exe__StringMap!))
                             qid/603 aliasmap/600))
                        with exn/1431
                         (if (== exn/1431 (field_imm 7 (global Stdlib!)))
                           (apply
                             (field_imm 1 (global Dune__exe__StringMap!))
                             qid/603
                             (makeblock 0 id/602
                               (apply
                                 (field_imm 1 (global Dune__exe__Positions!))
                                 decl/601))
                             aliasmap/600)
                           (reraise exn/1431)))
                      with (1 val/1430)
                       (apply (field_imm 5 (global Dune__exe__Error!))
                         (makeblock 0
                           (apply
                             (field_imm 1 (global Dune__exe__Positions!))
                             decl/601)
                           (makeblock 0 (field_imm 1 val/1430) 0))
                         [0:
                          [2:
                           0
                           [11:
                            " cannot be declared as an alias for the symbol "
                            [2:
                             0
                             [11:
                              ".\nIt has already been declared as an alias for "
                              [2: 0 [12: '.' 0]]]]]]
                          "%s cannot be declared as an alias for the symbol %s.\nIt has already been declared as an alias for %s."]
                         qid/603 id/602 (field_imm 0 val/1430))))))
              default: (exit 3))
            with (3) aliasmap/600))))
    (setfield_ptr(root-init) 1 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_declaration/598))
  (let
    (collect_aliases_from_grammar/646 =
       (function aliasmap/648 g/649
         (apply (field_imm 25 (global Stdlib__List!))
           (field_imm 1 (global Dune__exe__ExpandTokenAliases!)) aliasmap/648
           (field_imm 2 g/649))))
    (setfield_ptr(root-init) 2 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_grammar/646))
  (let
    (collect_aliases_from_grammars/716 =
       (function gs/718
         (apply (field_imm 25 (global Stdlib__List!))
           (field_imm 2 (global Dune__exe__ExpandTokenAliases!))
           (field_imm 0 (global Dune__exe__StringMap!)) gs/718)))
    (setfield_ptr(root-init) 3 (global Dune__exe__ExpandTokenAliases!)
      collect_aliases_from_grammars/716))
  (let
    (dealias_terminal/719 =
       (function aliasmap/721 pos/722 t/723
         (if (== (string.get t/723 0) '"')
           (catch
             (try
               (exit 4
                 (apply (field_imm 15 (global Dune__exe__StringMap!)) t/723
                   aliasmap/721))
              with exn/1438
               (if (== exn/1438 (field_imm 7 (global Stdlib!)))
                 (apply (field_imm 5 (global Dune__exe__Error!))
                   (makeblock 0 pos/722 0)
                   [0:
                    [11:
                     "the token alias " [2: 0 [11: " was never declared." 0]]]
                    "the token alias %s was never declared."]
                   t/723)
                 (reraise exn/1438)))
            with (4 val/1436) (field_imm 0 val/1436))
           t/723)))
    (setfield_ptr(root-init) 4 (global Dune__exe__ExpandTokenAliases!)
      dealias_terminal/719))
  (let
    (dealias_symbol/794 =
       (function aliasmap/796 sym/797
         (apply (field_imm 8 (global Dune__exe__Positions!))
           (apply (field_imm 4 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/796)
           sym/797)))
    (setfield_ptr(root-init) 5 (global Dune__exe__ExpandTokenAliases!)
      dealias_symbol/794))
  (letrec
    (dealias_parameter/798
       (function aliasmap/804 param/805
         (switch* param/805
          case tag 0:
           (makeblock 0
             (apply (field_imm 5 (global Dune__exe__ExpandTokenAliases!))
               aliasmap/804 (field_imm 0 param/805)))
          case tag 1:
           (makeblock 1
             (apply (field_imm 5 (global Dune__exe__ExpandTokenAliases!))
               aliasmap/804 (field_imm 0 param/805))
             (apply dealias_parameters/799 aliasmap/804
               (field_imm 1 param/805)))
          case tag 2:
           (makeblock 2
             (apply (field_imm 7 (global Dune__exe__Positions!))
               (apply dealias_branches/803 aliasmap/804)
               (field_imm 0 param/805)))))
      dealias_parameters/799
        (function aliasmap/845 params/846
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_parameter/798 aliasmap/845) params/846))
      dealias_producer/800
        (function aliasmap/847 producer/848
          (makeblock 0 (field_imm 0 producer/848)
            (apply dealias_parameter/798 aliasmap/847
              (field_imm 1 producer/848))
            (field_imm 2 producer/848)))
      dealias_producers/801
        (function aliasmap/852 producers/853
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_producer/800 aliasmap/852) producers/853))
      dealias_branch/802
        (function aliasmap/854 branch/855
          (makeblock 0 (field_imm 0 branch/855)
            (apply dealias_producers/801 aliasmap/854
              (field_imm 1 branch/855))
            (field_imm 2 branch/855) (field_imm 3 branch/855)
            (field_imm 4 branch/855)))
      dealias_branches/803
        (function aliasmap/856 branches/857
          (apply (field_imm 19 (global Stdlib__List!))
            (apply dealias_branch/802 aliasmap/856) branches/857)))
    (seq
      (setfield_ptr(root-init) 6 (global Dune__exe__ExpandTokenAliases!)
        dealias_parameter/798)
      (setfield_ptr(root-init) 7 (global Dune__exe__ExpandTokenAliases!)
        dealias_parameters/799)
      (setfield_ptr(root-init) 8 (global Dune__exe__ExpandTokenAliases!)
        dealias_producer/800)
      (setfield_ptr(root-init) 9 (global Dune__exe__ExpandTokenAliases!)
        dealias_producers/801)
      (setfield_ptr(root-init) 10 (global Dune__exe__ExpandTokenAliases!)
        dealias_branch/802)
      (setfield_ptr(root-init) 11 (global Dune__exe__ExpandTokenAliases!)
        dealias_branches/803)))
  (let
    (dealias_rule/858 =
       (function aliasmap/860 rule/861
         (makeblock 0 (int,int,*,*,*,*,*) (field_int 0 rule/861)
           (field_int 1 rule/861) (field_imm 2 rule/861)
           (field_imm 3 rule/861) (field_imm 4 rule/861)
           (field_imm 5 rule/861)
           (apply (field_imm 11 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/860 (field_imm 6 rule/861)))))
    (setfield_ptr(root-init) 12 (global Dune__exe__ExpandTokenAliases!)
      dealias_rule/858))
  (let
    (dealias_decl/862 =
       (function aliasmap/864 decl/865
         (apply (field_imm 8 (global Dune__exe__Positions!))
           (function pos/866 decl/867
             (switch decl/867
              case tag 4:
               (makeblock 4 (*,int,*)
                 (apply (field_imm 4 (global Dune__exe__ExpandTokenAliases!))
                   aliasmap/864 pos/866 (field_imm 0 decl/867))
                 (field_imm 1 decl/867) (field_imm 2 decl/867))
              case tag 5:
               (makeblock 5 (field_imm 0 decl/867)
                 (apply (field_imm 6 (global Dune__exe__ExpandTokenAliases!))
                   aliasmap/864 (field_imm 1 decl/867)))
              case tag 7:
               (makeblock 7
                 (apply (field_imm 7 (global Dune__exe__ExpandTokenAliases!))
                   aliasmap/864 (field_imm 0 decl/867))
                 (field_imm 1 decl/867))
              case tag 8:
               (makeblock 8
                 (apply (field_imm 6 (global Dune__exe__ExpandTokenAliases!))
                   aliasmap/864 (field_imm 0 decl/867))
                 (field_imm 1 decl/867))
              default: decl/867))
           decl/865)))
    (setfield_ptr(root-init) 13 (global Dune__exe__ExpandTokenAliases!)
      dealias_decl/862))
  (let
    (dealias_grammar/897 =
       (function aliasmap/899 g/900
         (makeblock 0 (field_imm 0 g/900) (field_imm 1 g/900)
           (apply (field_imm 19 (global Stdlib__List!))
             (apply (field_imm 13 (global Dune__exe__ExpandTokenAliases!))
               aliasmap/899)
             (field_imm 2 g/900))
           (apply (field_imm 19 (global Stdlib__List!))
             (apply (field_imm 12 (global Dune__exe__ExpandTokenAliases!))
               aliasmap/899)
             (field_imm 3 g/900)))))
    (setfield_ptr(root-init) 14 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammar/897))
  (let
    (dealias_grammars/901 =
       (function aliasmap/903 gs/904
         (apply (field_imm 19 (global Stdlib__List!))
           (apply (field_imm 14 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/903)
           gs/904)))
    (setfield_ptr(root-init) 15 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammars/901))
  (let
    (dealias_grammars/905 =
       (function gs/906
         (let
           (aliasmap/907 =
              (apply (field_imm 3 (global Dune__exe__ExpandTokenAliases!))
                gs/906))
           (apply (field_imm 15 (global Dune__exe__ExpandTokenAliases!))
             aliasmap/907 gs/906))))
    (setfield_ptr(root-init) 0 (global Dune__exe__ExpandTokenAliases!)
      dealias_grammars/905))
  0)
